<!DOCTYPE html>
<html lang="en"><head>
<script src="Benchmarking en Cadenas MCMC_files/libs/clipboard/clipboard.min.js"></script>
<script src="Benchmarking en Cadenas MCMC_files/libs/quarto-html/tabby.min.js"></script>
<script src="Benchmarking en Cadenas MCMC_files/libs/quarto-html/popper.min.js"></script>
<script src="Benchmarking en Cadenas MCMC_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Benchmarking en Cadenas MCMC_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Benchmarking en Cadenas MCMC_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Benchmarking en Cadenas MCMC_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Benchmarking en Cadenas MCMC_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Andrés Gutierrez y Stalyn Guerrero">
  <meta name="dcterms.date" content="2025-10-02">
  <title>Benchmarking en Cadenas MCMC</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Benchmarking en Cadenas MCMC_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Benchmarking en Cadenas MCMC_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Benchmarking en Cadenas MCMC_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="styles.css">
  <link href="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="Benchmarking en Cadenas MCMC_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="Benchmarking en Cadenas MCMC_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Benchmarking en Cadenas MCMC</h1>
  <p class="subtitle">Aplicación al Ingreso Medio e Indicadores del Mercado Laboral</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Andrés Gutierrez y Stalyn Guerrero 
</div>
</div>
</div>

  <p class="date">2025-10-02</p>
</section>
<section id="introducción-i" class="slide level2">
<h2>Introducción (I)</h2>
<ul>
<li><p>En la inferencia Bayesiana para estimación de áreas pequeñas (SAE), los métodos de Monte Carlo por Cadenas de Markov (MCMC) permiten aproximar distribuciones posteriores complejas.</p></li>
<li><p>Estos métodos se emplean para modelos con:</p>
<ul>
<li>Estructura jerárquica.<br>
</li>
<li>Supuestos de distribución no estándar.</li>
</ul></li>
<li><p>La validez de los estimadores depende de la convergencia y eficiencia de las cadenas.</p></li>
</ul>
</section>
<section id="introducción-ii" class="slide level2">
<h2>Introducción (II)</h2>
<ul>
<li><p>El proceso de benchmarking de cadenas MCMC es crucial en SAE, porque:</p>
<ul>
<li><p>Garantiza que las estimaciones desagregadas (ej. tasas de ocupación, participación o desempleo por área pequeña) sean coherentes con los niveles de agregación donde la encuesta es representativa, por ejemplo, divisiones administrativas mayores o nivel nacional.</p></li>
<li><p>Debe tenerse presente que el benchmarking es un procedimiento de ajuste estético: no mejora la calidad intrínseca del estimador, pero sí asegura consistencia y comparabilidad.</p></li>
</ul></li>
<li><p>Como ejemplo, se usarán:</p>
<ul>
<li>El ingreso medio</li>
<li>Los indicadores del mercado laboral (TO, TP y TD).</li>
</ul></li>
</ul>
<p>Donde la calidad de las cadenas impacta directamente la precisión y coherencia de los estimadores por dominio.</p>
</section>
<section>
<section id="modelo-de-unidad" class="title-slide slide level1 center">
<h1>Modelo de unidad</h1>

</section>
<section id="modelo-de-unidad-para-la-estimación-del-ingreso-medio" class="slide level2">
<h2>Modelo de unidad para la estimación del ingreso medio</h2>
<p>Uno de los primeros problemas a los que debemos enfrentarnos es la estimación del ingreso medio, la cual en una variable no simétrica que toma valores en los positivos. Sin embargo, empleando los métodos Bayesiano es posible obtener estimaciones de esta sin realizar una transformación</p>
</section>
<section id="obejtivo" class="slide level2">
<h2>Obejtivo</h2>
<ul>
<li>Estimar el <strong>ingreso medio</strong> de las personas en cada dominio <span class="math inline">\(d\)</span>:</li>
</ul>
<p><span class="math display">\[
\bar{Y}_d = \frac{\sum_{U_d}y_{di}}{N_d}
\]</span> - Donde <span class="math inline">\(y_{di}\)</span> es el ingreso de cada persona <span class="math inline">\(i\)</span> en el dominio <span class="math inline">\(d\)</span> y <span class="math inline">\(U_d\)</span> es la población del dominio.</p>
</section>
<section id="descomposición-muestral" class="slide level2">
<h2>Descomposición muestral</h2>
<ul>
<li>Separando la población en la <strong>muestra</strong> <span class="math inline">\(s_d\)</span> y el <strong>complemento fuera de muestra</strong> <span class="math inline">\(s_d^c\)</span>:</li>
</ul>
<p><span class="math display">\[
\begin{equation*}
\bar{Y}_d =  \frac{\sum_{s_d}y_{di} + \sum_{s^c_d}y_{di}}{N_d}
\end{equation*}
\]</span></p>
<ul>
<li>Esto muestra que el ingreso medio del dominio depende tanto de los datos observados como de los no observados.</li>
</ul>
</section>
<section id="estimador-bajo-modelo-de-unidad-i" class="slide level2">
<h2>Estimador bajo modelo de unidad (I)</h2>
<ul>
<li>Sustituimos los valores fuera de muestra por predicciones del modelo:</li>
</ul>
<p><span class="math display">\[
\hat{\bar{Y}}_d = \frac{\sum_{s_d}y_{di} + \sum_{s^c_d}\hat{y}_{di}}{N_d}
\]</span></p>
<ul>
<li>Donde</li>
</ul>
<p><span class="math display">\[
\hat{y}_{di} = E_{\mathscr{M}}\left(y_{di} \mid \mathbf{x}_d, \boldsymbol{\beta}\right)
\]</span></p>
<p>y <span class="math inline">\(\mathscr{M}\)</span> es la medida de probabilidad inducida por el modelamiento.</p>
</section>
<section id="estimador-bajo-modelo-de-unidad-ii" class="slide level2">
<h2>Estimador bajo modelo de unidad (II)</h2>
<ul>
<li>De esta forma:</li>
</ul>
<p><span class="math display">\[
\hat{\bar{Y}}_d = \frac{\sum_{i \in U_d} \hat{y}_{di}}{N_d}
\]</span></p>
<ul>
<li>Es decir, el estimador combina la información muestral con las predicciones del modelo para toda la población.</li>
</ul>
</section>
<section id="modelo-bayesiano-i" class="slide level2">
<h2>Modelo Bayesiano (I)</h2>
<ul>
<li>Para predecir el ingreso medio en personas no observadas, se asume el siguiente modelo jerárquico:</li>
</ul>
<p><span class="math display">\[
\begin{eqnarray*}
Y_{di} &amp;\sim &amp; N\left(\mu_{di},\sigma_e^{2}\right)\\
\mu_{di}&amp;=&amp;\boldsymbol{x}_{di}^{T}\boldsymbol{\beta}+u_{d}+e_{di}
\end{eqnarray*}
\]</span></p>
<ul>
<li>Donde:
<ul>
<li><span class="math inline">\(Y_{di}\)</span> = ingreso de la <span class="math inline">\(i\)</span>-ésima persona en el dominio <span class="math inline">\(d\)</span><br>
</li>
<li><span class="math inline">\(\mathbf{x}_{di}\)</span> = covariables observadas<br>
</li>
<li><span class="math inline">\(\boldsymbol{\beta}\)</span> = vector de coeficientes fijos<br>
</li>
<li><span class="math inline">\(u_d\)</span> = efecto aleatorio del dominio <span class="math inline">\(d\)</span><br>
</li>
<li><span class="math inline">\(e_{di}\)</span> = error individual</li>
</ul></li>
</ul>
</section>
<section id="modelo-bayesiano-ii" class="slide level2">
<h2>Modelo Bayesiano (II)</h2>
<ul>
<li>Supuestos de los componentes aleatorios:</li>
</ul>
<p><span class="math display">\[
u_d \sim N(0, \sigma_u^2), \quad
e_{di} \sim N(0, \sigma_e^2)
\]</span></p>
<ul>
<li><p>Los efectos aleatorios permiten capturar la <strong>heterogeneidad entre dominios</strong> y la variabilidad individual dentro de cada dominio.</p></li>
<li><p>Esto convierte el modelo en un <strong>modelo lineal jerárquico normal</strong> aplicado a unidades.</p></li>
</ul>
</section>
<section id="modelo-bayesiano-iii" class="slide level2">
<h2>Modelo Bayesiano (III)</h2>
<ul>
<li>Priors <strong>no informativos</strong> usados para la inferencia Bayesiana:</li>
</ul>
<p><span class="math display">\[
\beta_k \sim N(0, 1000), \quad
\sigma_e^2 \sim IG(0.0001, 0.0001)
\]</span></p>
<ul>
<li>El proceso de predicción del ingreso medio en dominios no observados se realiza mediante <strong>MCMC</strong>, combinando la información muestral y la estructura del modelo jerárquico.<br>
</li>
<li>Esta aproximación permite:
<ul>
<li>Propagar la incertidumbre de los parámetros.<br>
</li>
<li>Obtener predicciones consistentes a nivel de unidad y dominio.</li>
</ul></li>
</ul>
</section>
<section id="proceso-de-estimación-en-r-i" class="slide level2">
<h2>Proceso de estimación en <code>R</code> (I)</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Librerías principales utilizadas:</strong></p>
</div>
<div class="callout-content">
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-1_8fce7b6b99f51ea21cad52a631773e5a">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Interprete de STAN en R</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(rstan)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Manejo de bases de datos.</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># Gráficas de los modelos. </span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># Organizar la presentación de las tablas</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">library</span>(printr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="proceso-de-estimación-en-r-ii" class="slide level2 scroll-container">
<h2>Proceso de estimación en <code>R</code> (II)</h2>
<ul>
<li>Funciones desarrolladas para simplificar la metodología (archivo <code>funciones_mrp.R</code>):</li>
</ul>
<ol type="1">
<li><strong>plot_interaction</strong>:
<ul>
<li>Crea diagramas de líneas para estudiar la interacción entre variables.</li>
<li>Útil para detectar solapamientos y decidir si incluir interacción en el modelo.</li>
</ul></li>
<li><strong>Plot_Compare</strong>:
<ul>
<li>Valida la homologación entre censo y encuesta.</li>
<li>Compara proporciones de variables homogéneas entre ambos conjuntos de datos.</li>
</ul></li>
<li><strong>Aux_Agregado</strong>:
<ul>
<li>Genera estimaciones a diferentes niveles de agregación.</li>
<li>Especialmente útil en procesos repetitivos o cuando se requiere análisis por dominios.</li>
</ul></li>
</ol>
<p><strong>Las funciones están diseñada específicamente para este proceso</strong></p>
</section>
<section id="encuesta-de-hogares" class="slide level2">
<h2>Encuesta de hogares</h2>
<p>Los datos empleados en esta ocasión corresponden a la ultima encuesta de hogares, la cual ha sido estandarizada por <em>CEPAL</em> y se encuentra disponible en <em>BADEHOG</em></p>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-3_a915d96ed9433cef38ce94f06c05b98b">
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dam2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">upm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estrato</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ingreso</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">li</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">logingreso</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">anoest</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">edad</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">etnia</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">fep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">250000.0</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">12.4292</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">211091.0</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">12.2600</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">296750.0</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">12.6006</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">296750.0</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">12.6006</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">113889.0</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">11.6430</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">113889.0</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">11.6430</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">113889.0</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">11.6430</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">231666.5</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">12.3531</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">231666.5</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">12.3531</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: right;">1100100001</td>
<td style="text-align: right;">11001</td>
<td style="text-align: right;">418750.0</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">12.9450</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="variables-de-la-encuesta" class="slide level2">
<h2>Variables de la encuesta</h2>
<ul>
<li><p><em>dam</em>: Corresponde al código asignado a la división administrativa mayor del país.</p></li>
<li><p><em>dam2</em>: Corresponde al código asignado a la segunda división administrativa del país.</p></li>
<li><p><em>lp</em> y <em>li</em> lineas de pobreza y pobreza extrema definidas por CEPAL.</p></li>
<li><p><em>área</em> división geográfica (Urbano y Rural).</p></li>
<li><p><em>sexo</em> Hombre y Mujer.</p></li>
<li><p><em>etnia</em> En estas variable se definen tres grupos: afrodescendientes, indígenas y Otros.</p></li>
<li><p><em>anoest</em> Años de escolaridad</p></li>
<li><p><em>edad</em> Rangos de edad</p></li>
<li><p><em>fep</em> Factor de expansión por persona</p></li>
</ul>
</section>
<section id="validación-de-encuesta-frente-al-censo." class="slide level2">
<h2>Validación de encuesta frente al censo.</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-5_0b9e1714b787b14407fdec09b920e612">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/plot_comp.png" width="1000" height="650"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="información-auxiliar-i" class="slide level2">
<h2>Información Auxiliar (I)</h2>
<ul>
<li>La información auxiliar proviene de:
<ul>
<li><strong>Censo de población</strong></li>
<li><strong>Imágenes satelitales</strong></li>
</ul></li>
<li>Variables estandarizadas (ejemplo):
<ul>
<li>Luces nocturnas<br>
</li>
<li>Cobertura de cultivos y urbano<br>
</li>
<li>Modificación humana<br>
</li>
<li>Accesibilidad a hospitales</li>
</ul></li>
</ul>
</section>
<section id="información-auxiliar-ii" class="slide level2">
<h2>Información Auxiliar (II)</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-6_8ae72616ace6f689db6afc91b6074fb6">
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">area0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">area1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">etnia2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sexo2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest99</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">etnia1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">piso_tierra</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">material_paredes</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">material_techo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rezago_escolar</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">alfabeta</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tasa_desocupacion</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pollution_CO</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">vegetation_NDVI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Elevation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">temperature_ECMWF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">temperature_2metros</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_precipitation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">precipitation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">population_density</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">luces_nocturnas</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cubrimiento_cultivo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cubrimiento_urbano</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">modificacion_humana</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">accesibilidad_hospitales</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">accesibilidad_hosp_caminado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01101</td>
<td style="text-align: right;">0.0126</td>
<td style="text-align: right;">0.9874</td>
<td style="text-align: right;">0.0016</td>
<td style="text-align: right;">0.5044</td>
<td style="text-align: right;">0.2374</td>
<td style="text-align: right;">0.2338</td>
<td style="text-align: right;">0.2242</td>
<td style="text-align: right;">0.0926</td>
<td style="text-align: right;">0.1360</td>
<td style="text-align: right;">0.4547</td>
<td style="text-align: right;">0.2711</td>
<td style="text-align: right;">0.0245</td>
<td style="text-align: right;">0.1709</td>
<td style="text-align: right;">0.0051</td>
<td style="text-align: right;">0.2133</td>
<td style="text-align: right;">0.5059</td>
<td style="text-align: right;">0.3940</td>
<td style="text-align: right;">0.0285</td>
<td style="text-align: right;">0.0703</td>
<td style="text-align: right;">0.0229</td>
<td style="text-align: right;">-1.7713</td>
<td style="text-align: right;">-0.0492</td>
<td style="text-align: right;">2.0871</td>
<td style="text-align: right;">1.3892</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0057</td>
<td style="text-align: right;">-0.3101</td>
<td style="text-align: right;">-0.4713</td>
<td style="text-align: right;">-0.9633</td>
<td style="text-align: right;">-0.3591</td>
<td style="text-align: right;">-0.6911</td>
<td style="text-align: right;">0.0238</td>
<td style="text-align: right;">0.0469</td>
</tr>
<tr class="even">
<td style="text-align: left;">01107</td>
<td style="text-align: right;">0.0230</td>
<td style="text-align: right;">0.9770</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;">0.4998</td>
<td style="text-align: right;">0.2723</td>
<td style="text-align: right;">0.2157</td>
<td style="text-align: right;">0.1863</td>
<td style="text-align: right;">0.0426</td>
<td style="text-align: right;">0.1856</td>
<td style="text-align: right;">0.5305</td>
<td style="text-align: right;">0.0978</td>
<td style="text-align: right;">0.0358</td>
<td style="text-align: right;">0.2949</td>
<td style="text-align: right;">0.0372</td>
<td style="text-align: right;">0.2447</td>
<td style="text-align: right;">0.5403</td>
<td style="text-align: right;">0.1832</td>
<td style="text-align: right;">0.0528</td>
<td style="text-align: right;">0.0851</td>
<td style="text-align: right;">0.0229</td>
<td style="text-align: right;">-1.7300</td>
<td style="text-align: right;">0.2182</td>
<td style="text-align: right;">2.3984</td>
<td style="text-align: right;">1.6136</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0078</td>
<td style="text-align: right;">-0.2644</td>
<td style="text-align: right;">-0.1883</td>
<td style="text-align: right;">-0.9633</td>
<td style="text-align: right;">-0.3157</td>
<td style="text-align: right;">-0.4150</td>
<td style="text-align: right;">-0.2180</td>
<td style="text-align: right;">-0.0922</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01401</td>
<td style="text-align: right;">0.3575</td>
<td style="text-align: right;">0.6425</td>
<td style="text-align: right;">0.0004</td>
<td style="text-align: right;">0.4280</td>
<td style="text-align: right;">0.2539</td>
<td style="text-align: right;">0.2415</td>
<td style="text-align: right;">0.2023</td>
<td style="text-align: right;">0.0719</td>
<td style="text-align: right;">0.1781</td>
<td style="text-align: right;">0.5285</td>
<td style="text-align: right;">0.1377</td>
<td style="text-align: right;">0.0280</td>
<td style="text-align: right;">0.4207</td>
<td style="text-align: right;">0.0193</td>
<td style="text-align: right;">0.6109</td>
<td style="text-align: right;">0.8826</td>
<td style="text-align: right;">0.2323</td>
<td style="text-align: right;">0.0513</td>
<td style="text-align: right;">0.0762</td>
<td style="text-align: right;">0.0209</td>
<td style="text-align: right;">-1.7393</td>
<td style="text-align: right;">0.9481</td>
<td style="text-align: right;">1.8649</td>
<td style="text-align: right;">1.5590</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0068</td>
<td style="text-align: right;">-0.3569</td>
<td style="text-align: right;">-0.5357</td>
<td style="text-align: right;">-0.9607</td>
<td style="text-align: right;">-0.3883</td>
<td style="text-align: right;">-1.3414</td>
<td style="text-align: right;">0.4371</td>
<td style="text-align: right;">0.1599</td>
</tr>
<tr class="even">
<td style="text-align: left;">01402</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.4744</td>
<td style="text-align: right;">0.2064</td>
<td style="text-align: right;">0.1792</td>
<td style="text-align: right;">0.2376</td>
<td style="text-align: right;">0.1568</td>
<td style="text-align: right;">0.2536</td>
<td style="text-align: right;">0.4256</td>
<td style="text-align: right;">0.0752</td>
<td style="text-align: right;">0.0720</td>
<td style="text-align: right;">0.8568</td>
<td style="text-align: right;">0.0194</td>
<td style="text-align: right;">0.6728</td>
<td style="text-align: right;">0.9187</td>
<td style="text-align: right;">0.1814</td>
<td style="text-align: right;">0.1854</td>
<td style="text-align: right;">0.0380</td>
<td style="text-align: right;">0.0190</td>
<td style="text-align: right;">-1.7546</td>
<td style="text-align: right;">2.2707</td>
<td style="text-align: right;">1.1709</td>
<td style="text-align: right;">0.6441</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0093</td>
<td style="text-align: right;">-0.3582</td>
<td style="text-align: right;">-0.5581</td>
<td style="text-align: right;">-0.9618</td>
<td style="text-align: right;">-0.3905</td>
<td style="text-align: right;">-1.4837</td>
<td style="text-align: right;">0.9270</td>
<td style="text-align: right;">0.2968</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01403</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0006</td>
<td style="text-align: right;">0.4242</td>
<td style="text-align: right;">0.2685</td>
<td style="text-align: right;">0.2378</td>
<td style="text-align: right;">0.2269</td>
<td style="text-align: right;">0.1209</td>
<td style="text-align: right;">0.2529</td>
<td style="text-align: right;">0.3686</td>
<td style="text-align: right;">0.1539</td>
<td style="text-align: right;">0.0799</td>
<td style="text-align: right;">0.8113</td>
<td style="text-align: right;">0.0864</td>
<td style="text-align: right;">0.9684</td>
<td style="text-align: right;">0.9782</td>
<td style="text-align: right;">0.2796</td>
<td style="text-align: right;">0.1937</td>
<td style="text-align: right;">0.0494</td>
<td style="text-align: right;">0.0153</td>
<td style="text-align: right;">-1.5885</td>
<td style="text-align: right;">4.3891</td>
<td style="text-align: right;">-1.1246</td>
<td style="text-align: right;">-2.0702</td>
<td style="text-align: right;">1e-04</td>
<td style="text-align: right;">0.0228</td>
<td style="text-align: right;">-0.3581</td>
<td style="text-align: right;">-0.5595</td>
<td style="text-align: right;">-0.9362</td>
<td style="text-align: right;">-0.3875</td>
<td style="text-align: right;">-1.4958</td>
<td style="text-align: right;">0.1454</td>
<td style="text-align: right;">-0.0117</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="niveles-de-agregación" class="slide level2">
<h2>Niveles de Agregación</h2>
<ul>
<li>De la literatura y simulaciones se concluye que:
<ul>
<li>Las predicciones con muestra sin agregar y agregada convergen a la media del dominio.<br>
</li>
<li>Usar muestra agregada reduce el tiempo computacional para la convergencia MCMC.</li>
</ul></li>
<li>Variables de agregación seleccionadas: dam2 (división administrativa menor), área, sexo, anoest (años de estudio), edad y etnia</li>
</ul>
</section>
<section id="encuesta-agregada" class="slide level2">
<h2>Encuesta Agregada</h2>
<ul>
<li>Construcción de la base de datos agregada:</li>
</ul>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-7_9e50b63a1854bd14e7ec7e715b50b9b3">
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">anoest</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">edad</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">etnia</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">logingreso</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">15101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">472</td>
<td style="text-align: right;">12.3795</td>
</tr>
<tr class="even">
<td style="text-align: left;">02101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">432</td>
<td style="text-align: right;">12.3392</td>
</tr>
<tr class="odd">
<td style="text-align: left;">02101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">430</td>
<td style="text-align: right;">12.5587</td>
</tr>
<tr class="even">
<td style="text-align: left;">01101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">415</td>
<td style="text-align: right;">12.5388</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">397</td>
<td style="text-align: right;">12.8147</td>
</tr>
<tr class="even">
<td style="text-align: left;">02101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">391</td>
<td style="text-align: right;">12.3121</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">389</td>
<td style="text-align: right;">12.2353</td>
</tr>
<tr class="even">
<td style="text-align: left;">01101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">377</td>
<td style="text-align: right;">12.3574</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li>Finalmente, se unifica con la información auxiliar:</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Código de R</strong></p>
</div>
<div class="callout-content">
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-8_1b53d923a9e76d3dbeb5cd0ba3a2377f">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>encuesta_df_agg <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(encuesta_df_agg, statelevel_predictors_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="definición-del-modelo-multinivel" class="slide level2">
<h2>Definición del Modelo Multinivel</h2>
<ul>
<li><p>Se utiliza un <strong>modelo jerárquico bayesiano</strong> para el ingreso medio: <span class="math display">\[
\begin{align*}
\log(Y_{di}) &amp;\sim (1 \mid dam2) + (1 \mid edad) + (1 \mid etnia) \\
&amp; + \beta_0 + \beta_1\times edad + \beta_2\times sexo + \beta_3\times tasa\_desocupacion \\
           &amp;+ \beta_4\times luces\_nocturnas + \beta_5\times cubrimiento\_cultivo \\
           &amp;+ \beta_6\times cubrimiento\_urbano + \beta_7\times modificacion\_humana
\end{align*}
\]</span></p></li>
<li><p>Estimado con <code>stan_lmer</code> (<code>rstanarm</code>).<br>
</p></li>
<li><p>Efecto aleatorio: <span class="math inline">\(u_d\)</span> por dominio (<code>dam2</code>).<br>
</p></li>
<li><p>Covariables: demográficas y satelitales.</p></li>
</ul>
</section>
<section id="proceso-de-estimación-en-r-i-1" class="slide level2">
<h2>Proceso de estimación en <code>R</code> (I)</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Código de R</strong></p>
</div>
<div class="callout-content">
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-9_04f6e093d88e412867e29e91cda16185">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">options</span>(<span class="at">MC.cores=</span>parallel<span class="sc">::</span><span class="fu">detectCores</span>()) <span class="co"># Permite procesar en paralelo. </span></span>
<span id="cb3-2"><a href="#cb3-2"></a>fit <span class="ot">&lt;-</span> <span class="fu">stan_lmer</span>(</span>
<span id="cb3-3"><a href="#cb3-3"></a>  logingreso <span class="sc">~</span>                               <span class="co"># Ingreso medio (Y)</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>    (<span class="dv">1</span> <span class="sc">|</span> dam2) <span class="sc">+</span>                          <span class="co"># Efecto aleatorio (ud)</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>    (<span class="dv">1</span> <span class="sc">|</span> edad) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>    (<span class="dv">1</span> <span class="sc">|</span> etnia) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>    sexo  <span class="sc">+</span>                               <span class="co"># Efecto fijo (Variables X)</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>    tasa_desocupacion <span class="sc">+</span> luces_nocturnas <span class="sc">+</span> cubrimiento_cultivo <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>    cubrimiento_urbano <span class="sc">+</span>  modificacion_humana  ,</span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="at">weights =</span> n,            <span class="co"># Número de observaciones. </span></span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="at">data =</span> encuesta_df_agg, <span class="co"># Encuesta agregada </span></span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="at">verbose =</span> <span class="cn">TRUE</span>,         <span class="co"># Muestre el avance del proceso</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>    <span class="at">chains =</span> <span class="dv">4</span>,             <span class="co"># Número de cadenas.</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="at">iter =</span> <span class="dv">2000</span>              <span class="co"># Número de realizaciones de la cadena</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>                )</span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="fu">saveRDS</span>(fit, <span class="at">file =</span> <span class="st">"Recursos/Día3/Sesion1/Data/fit_ingresos.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="proceso-de-estimación-en-r-ii-1" class="slide level2">
<h2>Proceso de estimación en <code>R</code> (II)</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Código de R</strong></p>
</div>
<div class="callout-content">
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-10_48008cd6de0c2a7187668cdc7ab8bfbc">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Recursos/fit_ingresos.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-11_60492545554060a2186e2af66f82f323">
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">(Intercept)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sexo2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tasa_desocupacion</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">luces_nocturnas</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cubrimiento_cultivo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cubrimiento_urbano</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">modificacion_humana</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01101</td>
<td style="text-align: right;">12.7397</td>
<td style="text-align: right;">0.1556</td>
<td style="text-align: right;">0.2782</td>
<td style="text-align: right;">0.3439</td>
<td style="text-align: right;">0.4195</td>
<td style="text-align: right;">-0.0619</td>
<td style="text-align: right;">-5.2773</td>
<td style="text-align: right;">0.2689</td>
<td style="text-align: right;">-0.0336</td>
<td style="text-align: right;">-0.0761</td>
<td style="text-align: right;">-0.076</td>
</tr>
<tr class="even">
<td style="text-align: left;">01107</td>
<td style="text-align: right;">12.4286</td>
<td style="text-align: right;">0.1556</td>
<td style="text-align: right;">0.2782</td>
<td style="text-align: right;">0.3439</td>
<td style="text-align: right;">0.4195</td>
<td style="text-align: right;">-0.0619</td>
<td style="text-align: right;">-5.2773</td>
<td style="text-align: right;">0.2689</td>
<td style="text-align: right;">-0.0336</td>
<td style="text-align: right;">-0.0761</td>
<td style="text-align: right;">-0.076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01401</td>
<td style="text-align: right;">12.3943</td>
<td style="text-align: right;">0.1556</td>
<td style="text-align: right;">0.2782</td>
<td style="text-align: right;">0.3439</td>
<td style="text-align: right;">0.4195</td>
<td style="text-align: right;">-0.0619</td>
<td style="text-align: right;">-5.2773</td>
<td style="text-align: right;">0.2689</td>
<td style="text-align: right;">-0.0336</td>
<td style="text-align: right;">-0.0761</td>
<td style="text-align: right;">-0.076</td>
</tr>
<tr class="even">
<td style="text-align: left;">01402</td>
<td style="text-align: right;">12.3550</td>
<td style="text-align: right;">0.1556</td>
<td style="text-align: right;">0.2782</td>
<td style="text-align: right;">0.3439</td>
<td style="text-align: right;">0.4195</td>
<td style="text-align: right;">-0.0619</td>
<td style="text-align: right;">-5.2773</td>
<td style="text-align: right;">0.2689</td>
<td style="text-align: right;">-0.0336</td>
<td style="text-align: right;">-0.0761</td>
<td style="text-align: right;">-0.076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01404</td>
<td style="text-align: right;">12.1660</td>
<td style="text-align: right;">0.1556</td>
<td style="text-align: right;">0.2782</td>
<td style="text-align: right;">0.3439</td>
<td style="text-align: right;">0.4195</td>
<td style="text-align: right;">-0.0619</td>
<td style="text-align: right;">-5.2773</td>
<td style="text-align: right;">0.2689</td>
<td style="text-align: right;">-0.0336</td>
<td style="text-align: right;">-0.0761</td>
<td style="text-align: right;">-0.076</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="validación-del-modelo-i" class="slide level2">
<h2>Validación del Modelo (I)</h2>
<ul>
<li>Comparación de densidades observadas vs predichas:</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Código de R</strong></p>
</div>
<div class="callout-content">
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-12_84456e05da8ea7fedabb63a251ff372e">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb5-3"><a href="#cb5-3"></a>encuesta_mrp2 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(encuesta_mrp, statelevel_predictors_df)</span>
<span id="cb5-4"><a href="#cb5-4"></a>y_pred_B <span class="ot">&lt;-</span> <span class="fu">posterior_epred</span>(fit, <span class="at">newdata =</span> encuesta_mrp2)</span>
<span id="cb5-5"><a href="#cb5-5"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>p1 <span class="ot">&lt;-</span>  <span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(encuesta_mrp2<span class="sc">$</span>logingreso),</span>
<span id="cb5-9"><a href="#cb5-9"></a>                 y_pred2)<span class="sc">/</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">exp</span>(<span class="fu">as.numeric</span>(encuesta_mrp2<span class="sc">$</span>logingreso))<span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb5-11"><a href="#cb5-11"></a>                 (<span class="fu">exp</span>(y_pred2)<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1500000</span>) </span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"Recursos/Ingreso.PNG"</span>, <span class="at">plot =</span> p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="validación-del-modelo-ii" class="slide level2">
<h2>Validación del Modelo (II)</h2>

<img data-src="Recursos/Ingreso.PNG" width="900" class="r-stretch quarto-figure-center"></section>
<section id="validación-del-modelo-iii" class="slide level2">
<h2>Validación del Modelo (III)</h2>
<ul>
<li>Convergencia de parámetros:
<ul>
<li>Gráficos de densidad, áreas posteriores y trazas MCMC.</li>
</ul></li>
</ul>

<img data-src="Recursos/Ingreso1.PNG" width="900" class="r-stretch quarto-figure-center"></section>
<section id="efectos-de-covariables" class="slide level2">
<h2>Efectos de Covariables</h2>
<ul>
<li>Distribución posterior de parámetros seleccionados:
<ul>
<li>Edad, sexo, luces nocturnas, cobertura y modificación humana.</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-17_58cccff132412ea75bc7dc87f8d54a2a">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/Ingreso2.PNG" width="900" height="500"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mcmc" class="slide level2">
<h2>MCMC</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-19_9395878f699cb5970d16140aa33371d8">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/Ingreso3.PNG" width="900" height="600"></p>
</figure>
</div>
</div>
</div>
<!-- ## Benchmarking: Definición -->
<!-- - Objetivo: ajustar factores de calibración $g_k$ para que las estimaciones a nivel desagregado respeten los **totales de la encuesta**. -->
<!-- - Condición de calibración: -->
<!-- $$ -->
<!-- \sum_{k} g_k n_k \mathbf{X}_k = T -->
<!-- $$ -->
<!-- donde   -->
<!-- - $n_k$: tamaño del post-estrato $k$,   -->
<!-- - $\mathbf{X}_k$: covariables expandidas,   -->
<!-- - $T$: totales poblacionales conocidos. -->
<!-- ## Paso 1: Totales de la Encuesta -->
<!-- $$ -->
<!-- \mathbf{t}_X = \sum_{i \in s} y_i f_{ep,i} \, \mathbf{x}_i -->
<!-- $$ -->
<!-- - $y_i$: variable de interés en la encuesta.   -->
<!-- - $f_{ep,i}$: factor de expansión del individuo $i$.   -->
<!-- - $\mathbf{x}_i$: dummies de las covariables de calibración. -->
<!-- ## Paso 2: Totales del Modelo -->
<!-- $$ -->
<!-- \hat{\mathbf{t}}_X = \sum_{k} n_k \, y_k \, \mathbf{x}_k -->
<!-- $$ -->
<!-- - $y_k$: variable de interés en el post-estrato.   -->
<!-- - $n_k$: tamaño del post-estrato $k$.   -->
<!-- - $\mathbf{x}_k$: covariables expandidas del post-estrato. -->
<!-- ## Paso 3: Factores de Calibración -->
<!-- Resolver: -->
<!-- $$ -->
<!-- g_k = h(\lambda^\top \mathbf{x}_k) -->
<!-- $$ -->
<!-- según el método:   -->
<!-- - **Lineal:** $g_k = 1 + \lambda^\top \mathbf{x}_k$   -->
<!-- - **Logit:** $g_k = \frac{\exp(\lambda^\top \mathbf{x}_k)}{1 + \exp(\lambda^\top \mathbf{x}_k)}$ -->
<!-- ## Paso 4: Totales Calibrados -->
<!-- $$ -->
<!-- \mathbf{t}_X^{(1)} = \sum_k g_k n_k \mathbf{x}_k -->
<!-- $$ -->
<!-- Condición de parada: -->
<!-- $$ -->
<!-- \mathbf{t}_X^{(1)} \approx \mathbf{t}_X -->
<!-- $$ -->
<!-- Repetir el proceso para la l-esima iteración $l = 1, 2, ..., L$, el objetivo es ajustar $g_k^l$ de tal manera que los totales estimados con el modelo igualen (o se acerquen) a los totales observados de la encuesta. -->
</section>
<section id="benchmarking-por-iteración-de-la-cadena-mcmc" class="slide level2">
<h2>Benchmarking por iteración de la cadena MCMC</h2>
<p>Para estimar correctamente la incertidumbre posterior y garantizar coherencia con los totales observados, el cálculo de los factores de calibración se repite para <strong>cada realización</strong> <span class="math inline">\(l\)</span> de la cadena MCMC. Así obtenemos una familia de factores <span class="math inline">\(\{g_k^{(l)}\}_{l=1}^L\)</span> y, a partir de ellos, una familia de estimadores calibrados <span class="math inline">\(\{\widehat{\bar{Y}}_d^{(l),\text{cal}}\}_{l=1}^L\)</span>.</p>
</section>
<section id="notación" class="slide level2">
<h2>Notación</h2>
<ul>
<li><p><span class="math inline">\(l = 1,\ldots,L\)</span>: índice de la iteración de la cadena MCMC.</p></li>
<li><p><span class="math inline">\(\boldsymbol{\theta}^{(l)}\)</span>: vector de parámetros muestreados en la iteración <span class="math inline">\(l\)</span></p></li>
<li><p><span class="math inline">\(\hat{y}_k^{(l)}\)</span>: predicción del modelo para el post-estrato <span class="math inline">\(k\)</span> usando <span class="math inline">\(\boldsymbol{\theta}^{(l)}\)</span>.</p></li>
<li><p><span class="math inline">\(n_k\)</span>: tamaño del post-estrato <span class="math inline">\(k\)</span>.</p></li>
<li><p><span class="math inline">\(\mathbf{x}_k\)</span>: vector de calibración (dummies) del post-estrato <span class="math inline">\(k\)</span>.</p></li>
<li><p><span class="math inline">\(\mathbf{t}_X\)</span>: totales de encuesta conocidos (objetivo de calibración).</p></li>
</ul>
</section>
<section id="proceso-para-cada-iteración-l-i" class="slide level2">
<h2>Proceso para cada iteración <span class="math inline">\(l\)</span> (I)</h2>
<ol type="1">
<li><p><strong>Predicción condicional (con parámetros de la iteración):</strong> <span class="math display">\[
\hat{y}_k^{(l)} \;=\; E\big(y_k \mid \boldsymbol{\theta}^{(l)}, \mathbf{x}_k\big).
\]</span></p></li>
<li><p><strong>Totales del modelo en la iteración <span class="math inline">\(l\)</span>:</strong> <span class="math display">\[
\widehat{\mathbf{t}}_X^{(l)} \;=\; \sum_{k} n_k\,\hat{y}_k^{(l)}\,\mathbf{x}_k .
\]</span></p></li>
</ol>
</section>
<section id="proceso-para-cada-iteración-l-ii" class="slide level2">
<h2>Proceso para cada iteración <span class="math inline">\(l\)</span> (II)</h2>
<ol start="3" type="1">
<li><strong>Calibración — resolver para <span class="math inline">\(g_k^{(l)}\)</span>:</strong></li>
</ol>
<p>Encontrar <span class="math inline">\(g_k^{(l)}&gt;0\)</span> tales que</p>
<p><span class="math display">\[
\sum_{k} g_k^{(l)} \, n_k \, \mathbf{x}_k \;=\; \mathbf{t}_X .
\]</span> En la práctica se obtiene <span class="math inline">\(g_k^{(l)} = h(\lambda^{(l)\top}\mathbf{x}_k)\)</span>, donde <span class="math inline">\(\lambda^{(l)}\)</span> es el vector de Lagrange o parámetros de calibración de la iteración y <span class="math inline">\(h(\cdot)\)</span> depende del método (<code>linear</code>, <code>logit</code>).</p>
</section>
<section id="proceso-para-cada-iteración-l-iii" class="slide level2">
<h2>Proceso para cada iteración <span class="math inline">\(l\)</span> (III)</h2>
<ol start="4" type="1">
<li><strong>Estimador calibrado del ingreso medio por dominio <span class="math inline">\(d\)</span> en la iteración <span class="math inline">\(l\)</span>:</strong> <span class="math display">\[
\widehat{\bar{Y}}_d^{(l),\text{cal}} \;=\; \frac{1}{N_d}\sum_{k\in d} g_k^{(l)}\, n_k\, \hat{y}_k^{(l)}
\]</span></li>
</ol>
</section>
<section id="proceso-para-cada-iteración-l-iv" class="slide level2">
<h2>Proceso para cada iteración <span class="math inline">\(l\)</span> (IV)</h2>
<ol start="5" type="1">
<li><p><strong>Repetir para <span class="math inline">\(l=1,\dots,L\)</span>.</strong><br>
Obtener la muestra posterior calibrada: <span class="math display">\[
\{\widehat{\bar{Y}}_d^{(l),\text{cal}}\}_{l=1}^L .
\]</span></p></li>
<li><p><strong>Resumen posterior calibrado (estimador final y credibilidad):</strong> <span class="math display">\[
\widehat{\bar{Y}}_d^{\text{cal}} \;=\; \frac{1}{L}\sum_{l=1}^L \widehat{\bar{Y}}_d^{(l),\text{cal}}, \qquad
\text{IC}_{1-\alpha}:\ \text{quantiles}\big(\{\widehat{\bar{Y}}_d^{(l),\text{cal}}\}\big).
\]</span></p></li>
</ol>
</section>
<section id="observaciones-prácticas-y-requisitos-i" class="slide level2">
<h2>Observaciones prácticas y requisitos (I)</h2>
<ul>
<li><p><strong>Positividad:</strong> exigir <span class="math inline">\(g_k^{(l)}&gt;0\)</span>. Si el método produce valores no positivos, rechazarlos o cambiar el enlace (p.ej. usar <code>logit</code>).</p></li>
<li><p><strong>Propagación de incertidumbre:</strong> este esquema incorpora la variabilidad debida tanto al modelo (a través de <span class="math inline">\(\boldsymbol{\theta}^{(l)}\)</span>) como al proceso de calibración (a través de <span class="math inline">\(\lambda^{(l)}\)</span> y <span class="math inline">\(g_k^{(l)}\)</span>).</p></li>
</ul>
</section>
<section id="observaciones-prácticas-y-requisitos-ii" class="slide level2">
<h2>Observaciones prácticas y requisitos (II)</h2>
<ul>
<li><p><strong>Costo computacional:</strong> la calibración por iteración incrementa el tiempo; por eso es habitual usar post-estratos agregados (reducir número de <span class="math inline">\(k\)</span>)</p></li>
<li><p><strong>Diagnósticos:</strong> revisar la distribución de <span class="math inline">\(\{g_k^{(l)}\}\)</span> (por ejemplo histogramas y percentiles) y comprobar que las sumas calibradas coincidan con <span class="math inline">\(\mathbf{t}_X\)</span> dentro de tolerancia numérica en cada <span class="math inline">\(l\)</span>.</p></li>
</ul>
</section>
<section id="proceso-de-estimación-y-predicción" class="slide level2">
<h2>Proceso de estimación y predicción</h2>
<p>Obtener el modelo es solo un paso más, ahora se debe realizar la predicción en el censo, el cual a sido previamente estandarizado y homologado con la encuesta.</p>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-20_30fb6b60f0d81dd9ff6fc84cf1b5377d">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>poststrat_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Recursos/censo_dam2.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>     <span class="fu">inner_join</span>(statelevel_predictors_df) </span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">tba</span>( poststrat_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dam2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">etnia</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">edad</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">anoest</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">area0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">area1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">etnia2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sexo2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest99</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">etnia1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">piso_tierra</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">material_paredes</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">material_techo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rezago_escolar</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">alfabeta</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tasa_desocupacion</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pollution_CO</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">vegetation_NDVI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Elevation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">temperature_ECMWF</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">temperature_2metros</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_precipitation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">precipitation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">population_density</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">luces_nocturnas</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cubrimiento_cultivo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cubrimiento_urbano</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">modificacion_humana</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">accesibilidad_hospitales</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">accesibilidad_hosp_caminado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">13201</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">46766</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">0.5157</td>
<td style="text-align: right;">0.2513</td>
<td style="text-align: right;">0.2042</td>
<td style="text-align: right;">0.2518</td>
<td style="text-align: right;">0.0765</td>
<td style="text-align: right;">0.1496</td>
<td style="text-align: right;">0.4951</td>
<td style="text-align: right;">0.2124</td>
<td style="text-align: right;">0.0280</td>
<td style="text-align: right;">0.1096</td>
<td style="text-align: right;">4e-04</td>
<td style="text-align: right;">0.0736</td>
<td style="text-align: right;">0.6202</td>
<td style="text-align: right;">0.3179</td>
<td style="text-align: right;">0.0385</td>
<td style="text-align: right;">0.0688</td>
<td style="text-align: right;">0.0202</td>
<td style="text-align: right;">-0.8190</td>
<td style="text-align: right;">0.1107</td>
<td style="text-align: right;">0.1069</td>
<td style="text-align: right;">0.1652</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0689</td>
<td style="text-align: right;">5.1790</td>
<td style="text-align: right;">2.6378</td>
<td style="text-align: right;">-0.3121</td>
<td style="text-align: right;">1.8661</td>
<td style="text-align: right;">1.7482</td>
<td style="text-align: right;">-0.4728</td>
<td style="text-align: right;">-0.1807</td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: left;">13119</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">45879</td>
<td style="text-align: right;">0.0066</td>
<td style="text-align: right;">0.9934</td>
<td style="text-align: right;">0.0003</td>
<td style="text-align: right;">0.5192</td>
<td style="text-align: right;">0.2480</td>
<td style="text-align: right;">0.1981</td>
<td style="text-align: right;">0.2666</td>
<td style="text-align: right;">0.0940</td>
<td style="text-align: right;">0.1333</td>
<td style="text-align: right;">0.4843</td>
<td style="text-align: right;">0.2623</td>
<td style="text-align: right;">0.0209</td>
<td style="text-align: right;">0.0989</td>
<td style="text-align: right;">6e-04</td>
<td style="text-align: right;">0.0728</td>
<td style="text-align: right;">0.5547</td>
<td style="text-align: right;">0.3691</td>
<td style="text-align: right;">0.0295</td>
<td style="text-align: right;">0.0673</td>
<td style="text-align: right;">0.0208</td>
<td style="text-align: right;">-0.6038</td>
<td style="text-align: right;">-0.2372</td>
<td style="text-align: right;">0.7445</td>
<td style="text-align: right;">0.8473</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0320</td>
<td style="text-align: right;">4.8237</td>
<td style="text-align: right;">2.1005</td>
<td style="text-align: right;">0.5322</td>
<td style="text-align: right;">1.1706</td>
<td style="text-align: right;">1.6470</td>
<td style="text-align: right;">-0.4610</td>
<td style="text-align: right;">-0.1696</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">13101</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">40861</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.0013</td>
<td style="text-align: right;">0.4890</td>
<td style="text-align: right;">0.3123</td>
<td style="text-align: right;">0.3170</td>
<td style="text-align: right;">0.1746</td>
<td style="text-align: right;">0.0742</td>
<td style="text-align: right;">0.0780</td>
<td style="text-align: right;">0.3337</td>
<td style="text-align: right;">0.4832</td>
<td style="text-align: right;">0.0279</td>
<td style="text-align: right;">0.0798</td>
<td style="text-align: right;">3e-04</td>
<td style="text-align: right;">0.2288</td>
<td style="text-align: right;">0.3063</td>
<td style="text-align: right;">0.6032</td>
<td style="text-align: right;">0.0201</td>
<td style="text-align: right;">0.0581</td>
<td style="text-align: right;">0.0220</td>
<td style="text-align: right;">-1.4233</td>
<td style="text-align: right;">-0.1928</td>
<td style="text-align: right;">0.4775</td>
<td style="text-align: right;">0.6273</td>
<td style="text-align: right;">1e-04</td>
<td style="text-align: right;">0.0752</td>
<td style="text-align: right;">2.4286</td>
<td style="text-align: right;">2.9204</td>
<td style="text-align: right;">-0.9204</td>
<td style="text-align: right;">3.7382</td>
<td style="text-align: right;">2.2047</td>
<td style="text-align: right;">-0.4918</td>
<td style="text-align: right;">-0.1880</td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: left;">13201</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">39566</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">0.5157</td>
<td style="text-align: right;">0.2513</td>
<td style="text-align: right;">0.2042</td>
<td style="text-align: right;">0.2518</td>
<td style="text-align: right;">0.0765</td>
<td style="text-align: right;">0.1496</td>
<td style="text-align: right;">0.4951</td>
<td style="text-align: right;">0.2124</td>
<td style="text-align: right;">0.0280</td>
<td style="text-align: right;">0.1096</td>
<td style="text-align: right;">4e-04</td>
<td style="text-align: right;">0.0736</td>
<td style="text-align: right;">0.6202</td>
<td style="text-align: right;">0.3179</td>
<td style="text-align: right;">0.0385</td>
<td style="text-align: right;">0.0688</td>
<td style="text-align: right;">0.0202</td>
<td style="text-align: right;">-0.8190</td>
<td style="text-align: right;">0.1107</td>
<td style="text-align: right;">0.1069</td>
<td style="text-align: right;">0.1652</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0689</td>
<td style="text-align: right;">5.1790</td>
<td style="text-align: right;">2.6378</td>
<td style="text-align: right;">-0.3121</td>
<td style="text-align: right;">1.8661</td>
<td style="text-align: right;">1.7482</td>
<td style="text-align: right;">-0.4728</td>
<td style="text-align: right;">-0.1807</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">13201</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">38791</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">0.5157</td>
<td style="text-align: right;">0.2513</td>
<td style="text-align: right;">0.2042</td>
<td style="text-align: right;">0.2518</td>
<td style="text-align: right;">0.0765</td>
<td style="text-align: right;">0.1496</td>
<td style="text-align: right;">0.4951</td>
<td style="text-align: right;">0.2124</td>
<td style="text-align: right;">0.0280</td>
<td style="text-align: right;">0.1096</td>
<td style="text-align: right;">4e-04</td>
<td style="text-align: right;">0.0736</td>
<td style="text-align: right;">0.6202</td>
<td style="text-align: right;">0.3179</td>
<td style="text-align: right;">0.0385</td>
<td style="text-align: right;">0.0688</td>
<td style="text-align: right;">0.0202</td>
<td style="text-align: right;">-0.8190</td>
<td style="text-align: right;">0.1107</td>
<td style="text-align: right;">0.1069</td>
<td style="text-align: right;">0.1652</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0689</td>
<td style="text-align: right;">5.1790</td>
<td style="text-align: right;">2.6378</td>
<td style="text-align: right;">-0.3121</td>
<td style="text-align: right;">1.8661</td>
<td style="text-align: right;">1.7482</td>
<td style="text-align: right;">-0.4728</td>
<td style="text-align: right;">-0.1807</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Note que la información del censo esta agregada.</p>
</section>
<section id="distribución-posterior." class="slide level2">
<h2>Distribución posterior.</h2>
<p>Para obtener una distribución posterior de cada observación se hace uso de la función <em>posterior_epred</em> de la siguiente forma.</p>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-21_854c245df78d3f4e20e9e519963d8961">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>epred_mat <span class="ot">&lt;-</span> <span class="fu">posterior_epred</span>(fit, <span class="at">newdata =</span> poststrat_df,  <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">saveRDS</span>(epred_mat, <span class="st">"recursos/epred_mat.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proceso-de-estimación-en-r-i-2" class="slide level2">
<h2>Proceso de estimación en <code>R</code> (I)</h2>
<p>En cada iteración <span class="math inline">\(l\)</span> de la cadena MCMC:</p>
<ol type="1">
<li>Sustituir <span class="math inline">\(\hat{y}_k^{(l)}\)</span> en la tabla de post-estratificación.<br>
</li>
<li>Construir la matriz de calibración <span class="math inline">\(\mathbf{X}_k\)</span>.</li>
</ol>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-22_72d60bae5deee2faed771afeaeb52b41">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(sampling)</span>
<span id="cb8-2"><a href="#cb8-2"></a>epred_mat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"recursos/epred_mat.rds"</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>iter <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb8-5"><a href="#cb8-5"></a>names_cov <span class="ot">&lt;-</span> <span class="st">"dam"</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>metodo <span class="ot">&lt;-</span> <span class="st">"linear"</span></span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># 1. Predicciones en el post-estrato</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>temp_post <span class="ot">&lt;-</span> poststrat_df <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="fu">mutate</span>(<span class="at">yk =</span> epred_mat[iter,]) <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">select</span>(dam<span class="sc">:</span>n, yk)</span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># 2. Matriz de calibración</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>Xk <span class="ot">&lt;-</span> temp_post <span class="sc">%&gt;%</span> </span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(names_cov)) <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>  fastDummies<span class="sc">::</span><span class="fu">dummy_cols</span>(<span class="at">select_columns =</span> names_cov,</span>
<span id="cb8-17"><a href="#cb8-17"></a>                          <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">matches</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">d$"</span>)), <span class="sc">~</span> . <span class="sc">*</span> temp_post<span class="sc">$</span>yk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proceso-de-estimación-en-r-ii-2" class="slide level2">
<h2>Proceso de estimación en <code>R</code> (II)</h2>
<ol start="3" type="1">
<li>Calcular los totales de la encuesta <span class="math inline">\(\mathbf{t}_X\)</span>.<br>
</li>
</ol>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-23_2f5f3e55a9481e4011ecbf6118126208">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># 3. Totales de la encuesta</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>encuesta_sta <span class="ot">&lt;-</span> encuesta_mrp <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(names_cov)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  fastDummies<span class="sc">::</span><span class="fu">dummy_cols</span>(<span class="at">select_columns =</span> names_cov,</span>
<span id="cb9-5"><a href="#cb9-5"></a>                          <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a>Total_Xk <span class="ot">&lt;-</span> encuesta_sta <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">matches</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">d$"</span>)), </span>
<span id="cb9-9"><a href="#cb9-9"></a>            <span class="sc">~</span> . <span class="sc">*</span> encuesta_mrp<span class="sc">$</span>logingreso <span class="sc">*</span> encuesta_mrp<span class="sc">$</span>fep) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">colSums</span>()</span>
<span id="cb9-11"><a href="#cb9-11"></a>Total_Xk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  dam_01   dam_02   dam_03   dam_04   dam_05   dam_06   dam_07   dam_08 
 4298101  7372483  3518321  9408211 23069944 11392730 12746027 19925849 
  dam_09   dam_10   dam_11   dam_12   dam_13   dam_14   dam_15   dam_16 
12141267 10828235  1332260  1932517 91204327  4550614  1981897  5578108 </code></pre>
</div>
</div>
</section>
<section id="proceso-de-estimación-en-r-iii" class="slide level2">
<h2>Proceso de estimación en <code>R</code> (III)</h2>
<ol start="4" type="1">
<li>Resolver el sistema de calibración para obtener <span class="math inline">\(g_k^{(l)}\)</span>.</li>
</ol>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-24_3aa751cd5c826e7fe528dcf6a0451ebe">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># 4. Resolver calibración</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>gk_calib <span class="ot">&lt;-</span> <span class="fu">calib</span>(</span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="at">Xs =</span> Xk,</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="at">d =</span> temp_post<span class="sc">$</span>n,</span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="at">total =</span> Total_Xk,</span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="at">method =</span> metodo</span>
<span id="cb11-7"><a href="#cb11-7"></a>)</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="fu">summary</span>(gk_calib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Min.</th>
<th style="text-align: right;">1st Qu.</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">3rd Qu.</th>
<th style="text-align: right;">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.7053834</td>
<td style="text-align: right;">1.002673</td>
<td style="text-align: right;">1.020088</td>
<td style="text-align: right;">1.015225</td>
<td style="text-align: right;">1.044626</td>
<td style="text-align: right;">1.066852</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Diagnóstico</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>check_calib <span class="ot">&lt;-</span> <span class="fu">checkcalibration</span>(</span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="at">Xs =</span> Xk, <span class="at">d =</span> temp_post<span class="sc">$</span>n,</span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="at">total =</span> Total_Xk, <span class="at">g =</span> gk_calib</span>
<span id="cb12-5"><a href="#cb12-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proceso-de-estimación-en-r-iv" class="slide level2">
<h2>Proceso de estimación en <code>R</code> (IV)</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-25_a768a6786b890aa6a780367927c0476d">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Totales ajustados</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>hat_tx <span class="ot">&lt;-</span> Xk <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">matches</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">d$"</span>)), <span class="sc">~</span> . <span class="sc">*</span> temp_post<span class="sc">$</span>n <span class="sc">*</span> gk_calib) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">colSums</span>()</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="fu">round</span>(Total_Xk <span class="sc">-</span> hat_tx, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dam_01 dam_02 dam_03 dam_04 dam_05 dam_06 dam_07 dam_08 dam_09 dam_10 dam_11 
     0      0      0      0      0      0      0      0      0      0      0 
dam_12 dam_13 dam_14 dam_15 dam_16 
     0      0      0      0      0 </code></pre>
</div>
</div>
</section>
<section id="proceso-de-estimación-en-r-función-benchmarking" class="slide level2">
<h2>Proceso de estimación en <code>R</code> (Función benchmarking)</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-26_7a1afdad525d8615b2dec0e5114dc0d6">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">source</span>(<span class="st">"recursos/benchmarking_ingreso.r"</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a>poststrat_df_iter <span class="ot">&lt;-</span> <span class="fu">benchmarking</span>(</span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="at">poststrat_df =</span> temp_post <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(),</span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="at">encuesta_sta =</span> encuesta_mrp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">yk =</span> logingreso),</span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="at">names_cov =</span> <span class="st">"dam"</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="at">metodo =</span> <span class="st">"linear"</span>, </span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="at">show_plot =</span> <span class="cn">FALSE</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>)</span>
<span id="cb15-10"><a href="#cb15-10"></a></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="fu">tba</span>(poststrat_df_iter <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dam2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">etnia</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">edad</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">anoest</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">yk</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">12.3479</td>
<td style="text-align: right;">10.4898</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">12.3479</td>
<td style="text-align: right;">25.1754</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">12.3479</td>
<td style="text-align: right;">3.1469</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">98</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">12.3479</td>
<td style="text-align: right;">16.7836</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">01101</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">99</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.3479</td>
<td style="text-align: right;">1.0490</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="proceso-de-estimación-en-r-para-la-mcmc" class="slide level2">
<h2>Proceso de estimación en <code>R</code> para la MCMC</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-27_3b18ba56caa1c8d744acc1d2f7b4d9b2">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>poststrat_df_iter2 <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(epred_mat),</span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="sc">~</span>{</span>
<span id="cb16-3"><a href="#cb16-3"></a>temp_post <span class="ot">&lt;-</span> poststrat_df <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">mutate</span>(<span class="at">yk =</span> epred_mat[.x,]) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">select</span>(dam<span class="sc">:</span>n, yk)</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a>poststrat_df_iter <span class="ot">&lt;-</span> <span class="fu">benchmarking</span>(</span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="at">poststrat_df =</span> temp_post <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>(),</span>
<span id="cb16-9"><a href="#cb16-9"></a>  <span class="at">encuesta_sta =</span> encuesta_mrp <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">yk =</span> logingreso),</span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="at">names_cov =</span> <span class="st">"dam"</span>,</span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="at">metodo =</span> <span class="st">"logit"</span>, </span>
<span id="cb16-12"><a href="#cb16-12"></a>  <span class="at">show_plot =</span> <span class="cn">FALSE</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>)</span>
<span id="cb16-14"><a href="#cb16-14"></a>poststrat_df_iter</span>
<span id="cb16-15"><a href="#cb16-15"></a>  }</span>
<span id="cb16-16"><a href="#cb16-16"></a>)</span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="fu">saveRDS</span>(poststrat_df_iter2, <span class="st">"recursos/poststrat_df_iter_ingreso.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proceso-de-estimación-en-r-para-la-mcmc-sin-benchmarking" class="slide level2">
<h2>Proceso de estimación en <code>R</code> para la MCMC <strong>sin benchmarking</strong></h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-29_69f76b601428285284d16d12743dc699">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>theta_iter <span class="ot">&lt;-</span>  <span class="fu">map</span>(poststrat_df_iter3, <span class="sc">~</span>{</span>
<span id="cb17-2"><a href="#cb17-2"></a>    .x <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="fu">group_by</span>(dam) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="fu">summarise</span>(<span class="at">theta =</span> <span class="fu">sum</span>(yk<span class="sc">*</span>n))  </span>
<span id="cb17-5"><a href="#cb17-5"></a>}, <span class="at">.progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a>theta_modelo <span class="ot">&lt;-</span>  theta_iter <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="fu">group_by</span>(dam) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-10"><a href="#cb17-10"></a>        <span class="at">estimate =</span> <span class="fu">mean</span>(theta),</span>
<span id="cb17-11"><a href="#cb17-11"></a>        <span class="at">sd =</span> <span class="fu">sd</span>(theta),</span>
<span id="cb17-12"><a href="#cb17-12"></a>        <span class="at">lci =</span> <span class="fu">quantile</span>(theta, <span class="at">probs =</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.95</span>)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb17-13"><a href="#cb17-13"></a>        <span class="at">uci =</span> <span class="fu">quantile</span>(theta, <span class="at">probs =</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.95</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb17-14"><a href="#cb17-14"></a></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="fu">saveRDS</span>(theta_modelo, <span class="st">"recursos/02.theta_modelo_ingreso.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proceso-de-estimación-en-r-para-la-mcmc-con-benchmarking" class="slide level2">
<h2>Proceso de estimación en <code>R</code> para la MCMC <strong>con benchmarking</strong></h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-30_7eed7562c201c67f20b7e26ebfc9bc94">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>theta_iter2 <span class="ot">&lt;-</span>  <span class="fu">map</span>(poststrat_df_iter2, <span class="sc">~</span> {</span>
<span id="cb18-2"><a href="#cb18-2"></a>  .x <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>    <span class="fu">group_by</span>(dam) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="fu">summarise</span>(<span class="at">theta =</span> <span class="fu">sum</span>(yk<span class="sc">*</span>n2))</span>
<span id="cb18-5"><a href="#cb18-5"></a>}, <span class="at">.progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a>theta_bench <span class="ot">&lt;-</span> theta_iter2 <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="fu">group_by</span>(dam) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>  <span class="fu">summarise</span>(</span>
<span id="cb18-10"><a href="#cb18-10"></a>    <span class="at">estimate =</span> <span class="fu">mean</span>(theta),</span>
<span id="cb18-11"><a href="#cb18-11"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(theta),</span>
<span id="cb18-12"><a href="#cb18-12"></a>    <span class="at">lci =</span> <span class="fu">quantile</span>(theta, <span class="at">probs =</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.95</span>) <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb18-13"><a href="#cb18-13"></a>    <span class="at">uci =</span> <span class="fu">quantile</span>(theta, <span class="at">probs =</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.95</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb18-14"><a href="#cb18-14"></a>  )</span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="fu">saveRDS</span>(theta_bench, <span class="st">"recursos/03.theta_bench_ingreso.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparando-estimaciones-muestra-modelo-y-modelo-con-benchmarking" class="slide level2">
<h2>Comparando estimaciones muestra, modelo y modelo con benchmarking</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-31_f5b8b3c49576d1f5cd4d950b9d546323">
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">dam</th>
<th style="text-align: right;">modelo</th>
<th style="text-align: right;">bench</th>
<th style="text-align: right;">muestra</th>
<th style="text-align: right;">diff_bench</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dam_01</td>
<td style="text-align: right;">4098699</td>
<td style="text-align: right;">4298101</td>
<td style="text-align: right;">4298101</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dam_02</td>
<td style="text-align: right;">7634466</td>
<td style="text-align: right;">7372483</td>
<td style="text-align: right;">7372483</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dam_03</td>
<td style="text-align: right;">3525544</td>
<td style="text-align: right;">3518321</td>
<td style="text-align: right;">3518321</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dam_04</td>
<td style="text-align: right;">9179198</td>
<td style="text-align: right;">9408211</td>
<td style="text-align: right;">9408211</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dam_05</td>
<td style="text-align: right;">22575117</td>
<td style="text-align: right;">23069944</td>
<td style="text-align: right;">23069944</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dam_06</td>
<td style="text-align: right;">11194267</td>
<td style="text-align: right;">11392730</td>
<td style="text-align: right;">11392730</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dam_07</td>
<td style="text-align: right;">12712289</td>
<td style="text-align: right;">12746027</td>
<td style="text-align: right;">12746027</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dam_08</td>
<td style="text-align: right;">19040506</td>
<td style="text-align: right;">19925849</td>
<td style="text-align: right;">19925849</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dam_09</td>
<td style="text-align: right;">11612802</td>
<td style="text-align: right;">12141267</td>
<td style="text-align: right;">12141267</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dam_10</td>
<td style="text-align: right;">10163776</td>
<td style="text-align: right;">10828235</td>
<td style="text-align: right;">10828235</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dam_11</td>
<td style="text-align: right;">1303588</td>
<td style="text-align: right;">1332260</td>
<td style="text-align: right;">1332260</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dam_12</td>
<td style="text-align: right;">2121779</td>
<td style="text-align: right;">1932517</td>
<td style="text-align: right;">1932517</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dam_13</td>
<td style="text-align: right;">89572086</td>
<td style="text-align: right;">91204327</td>
<td style="text-align: right;">91204327</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dam_14</td>
<td style="text-align: right;">4707971</td>
<td style="text-align: right;">4550614</td>
<td style="text-align: right;">4550614</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dam_15</td>
<td style="text-align: right;">2785376</td>
<td style="text-align: right;">1981897</td>
<td style="text-align: right;">1981897</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dam_16</td>
<td style="text-align: right;">5824338</td>
<td style="text-align: right;">5578108</td>
<td style="text-align: right;">5578108</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="estimaciones-desagregadas-por-nacional" class="slide level2">
<h2>Estimaciones desagregadas por Nacional</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-32_d20ec94a2c71d1ec1f741e600a372397">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">source</span>(<span class="st">"recursos/calc_theta.R"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>poststrat_df_iter2  <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"recursos/poststrat_df_iter_ingreso.rds"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="fu">calc_theta</span>(<span class="at">result_list =</span> poststrat_df_iter2, </span>
<span id="cb19-4"><a href="#cb19-4"></a>           <span class="at">levels =</span> <span class="cn">NULL</span>, <span class="at">ci_level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$estimates
  estimate          sd     lci     uci
1 12.40798 0.001193038 12.4062 12.4094

$draws
      theta
1  12.40932
2  12.40799
3  12.40704
4  12.40898
5  12.40942
6  12.40761
7  12.40602
8  12.40738
9  12.40682
10 12.40917</code></pre>
</div>
</div>
</section>
<section id="estimaciones-desagregadas-por-dam---área" class="slide level2">
<h2>Estimaciones desagregadas por DAM - área</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-33_35ee214f4219f46e3071e0cb3b3a13b7">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">calc_theta</span>(</span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="at">result_list =</span> poststrat_df_iter2,</span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"dam"</span>, <span class="st">"area"</span>),</span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="at">ci_level =</span> <span class="fl">0.95</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>)<span class="sc">$</span>estimates <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">head</span>(<span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lci</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">uci</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">12.3587</td>
<td style="text-align: right;">0.0170</td>
<td style="text-align: right;">12.3329</td>
<td style="text-align: right;">12.3845</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.4025</td>
<td style="text-align: right;">0.0044</td>
<td style="text-align: right;">12.3965</td>
<td style="text-align: right;">12.4102</td>
</tr>
<tr class="odd">
<td style="text-align: left;">02</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">12.6600</td>
<td style="text-align: right;">0.0088</td>
<td style="text-align: right;">12.6505</td>
<td style="text-align: right;">12.6727</td>
</tr>
<tr class="even">
<td style="text-align: left;">02</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.5593</td>
<td style="text-align: right;">0.0048</td>
<td style="text-align: right;">12.5522</td>
<td style="text-align: right;">12.5663</td>
</tr>
<tr class="odd">
<td style="text-align: left;">03</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">12.2867</td>
<td style="text-align: right;">0.0120</td>
<td style="text-align: right;">12.2707</td>
<td style="text-align: right;">12.3072</td>
</tr>
<tr class="even">
<td style="text-align: left;">03</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.3231</td>
<td style="text-align: right;">0.0072</td>
<td style="text-align: right;">12.3095</td>
<td style="text-align: right;">12.3317</td>
</tr>
<tr class="odd">
<td style="text-align: left;">04</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">12.1178</td>
<td style="text-align: right;">0.0050</td>
<td style="text-align: right;">12.1109</td>
<td style="text-align: right;">12.1255</td>
</tr>
<tr class="even">
<td style="text-align: left;">04</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.1191</td>
<td style="text-align: right;">0.0030</td>
<td style="text-align: right;">12.1134</td>
<td style="text-align: right;">12.1220</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="estimaciones-desagregadas-por-dam---área---sexo" class="slide level2">
<h2>Estimaciones desagregadas por DAM - área - sexo</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-34_50ffd5103934fa4cc544b1635d8ed4a8">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">calc_theta</span>(<span class="at">result_list =</span> poststrat_df_iter2[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb22-2"><a href="#cb22-2"></a>           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"dam"</span>, <span class="st">"area"</span>, <span class="st">"sexo"</span>), <span class="at">ci_level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>estimates <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">head</span>(<span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lci</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">uci</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.3884</td>
<td style="text-align: right;">0.0147</td>
<td style="text-align: right;">12.3684</td>
<td style="text-align: right;">12.4129</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">12.2880</td>
<td style="text-align: right;">0.0235</td>
<td style="text-align: right;">12.2484</td>
<td style="text-align: right;">12.3170</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.4294</td>
<td style="text-align: right;">0.0047</td>
<td style="text-align: right;">12.4228</td>
<td style="text-align: right;">12.4372</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">12.3763</td>
<td style="text-align: right;">0.0042</td>
<td style="text-align: right;">12.3706</td>
<td style="text-align: right;">12.3838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">02</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.6768</td>
<td style="text-align: right;">0.0103</td>
<td style="text-align: right;">12.6660</td>
<td style="text-align: right;">12.6897</td>
</tr>
<tr class="even">
<td style="text-align: left;">02</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">12.5928</td>
<td style="text-align: right;">0.0095</td>
<td style="text-align: right;">12.5814</td>
<td style="text-align: right;">12.6053</td>
</tr>
<tr class="odd">
<td style="text-align: left;">02</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.5851</td>
<td style="text-align: right;">0.0051</td>
<td style="text-align: right;">12.5775</td>
<td style="text-align: right;">12.5933</td>
</tr>
<tr class="even">
<td style="text-align: left;">02</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">12.5335</td>
<td style="text-align: right;">0.0046</td>
<td style="text-align: right;">12.5268</td>
<td style="text-align: right;">12.5393</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="estimaciones-desagregadas-por-dam---área---etnia" class="slide level2">
<h2>Estimaciones desagregadas por DAM - área - etnia</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-35_3723582fbbca68f03a36ee7394e26231">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">calc_theta</span>(<span class="at">result_list =</span> poststrat_df_iter2[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], </span>
<span id="cb23-2"><a href="#cb23-2"></a>           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"dam"</span>, <span class="st">"area"</span>, <span class="st">"etnia"</span>),</span>
<span id="cb23-3"><a href="#cb23-3"></a>           <span class="at">ci_level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>estimates <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">head</span>(<span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">etnia</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lci</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">uci</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.3265</td>
<td style="text-align: right;">0.0301</td>
<td style="text-align: right;">12.2782</td>
<td style="text-align: right;">12.3707</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">12.3492</td>
<td style="text-align: right;">0.0119</td>
<td style="text-align: right;">12.3368</td>
<td style="text-align: right;">12.3705</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">12.3799</td>
<td style="text-align: right;">0.0103</td>
<td style="text-align: right;">12.3670</td>
<td style="text-align: right;">12.3973</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.3325</td>
<td style="text-align: right;">0.0038</td>
<td style="text-align: right;">12.3275</td>
<td style="text-align: right;">12.3396</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">12.4384</td>
<td style="text-align: right;">0.0045</td>
<td style="text-align: right;">12.4316</td>
<td style="text-align: right;">12.4453</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">12.4235</td>
<td style="text-align: right;">0.0046</td>
<td style="text-align: right;">12.4169</td>
<td style="text-align: right;">12.4314</td>
</tr>
<tr class="odd">
<td style="text-align: left;">02</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">12.6685</td>
<td style="text-align: right;">0.0119</td>
<td style="text-align: right;">12.6522</td>
<td style="text-align: right;">12.6821</td>
</tr>
<tr class="even">
<td style="text-align: left;">02</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">12.6647</td>
<td style="text-align: right;">0.0159</td>
<td style="text-align: right;">12.6452</td>
<td style="text-align: right;">12.6895</td>
</tr>
</tbody>
</table>


</div>
</div>
</section></section>
<section>
<section id="mercado-laboral" class="title-slide slide level1 center">
<h1>Mercado Laboral</h1>

</section>
<section id="indicadores-del-mercado-laboral" class="slide level2">
<h2>Indicadores del Mercado Laboral</h2>
<ul>
<li><p>Punto de partida: caracterizar la dinámica del mercado laboral.</p></li>
<li><p>Se emplean tres indicadores fundamentales:</p>
<ol type="1">
<li>Tasa de Ocupación (TO)</li>
<li>Tasa de Participación (TP)</li>
<li>Tasa de Desempleo (TD)</li>
</ol></li>
</ul>
</section>
<section id="tasa-de-ocupación-to" class="slide level2">
<h2>1. Tasa de Ocupación (TO)</h2>
<p><span class="math display">\[
TO = \frac{\text{Ocupados}}{\text{Población en Edad de Trabajar}} \times 100
\]</span></p>
<ul>
<li>Numerador: personas ocupadas (empleadas o ausentes temporalmente de un empleo).</li>
<li>Denominador: población en edad de trabajar (PET, usualmente ≥ 15 años).</li>
</ul>
<p>Interpretación: mide la capacidad de absorción del empleo en la población disponible.</p>
</section>
<section id="tasa-de-participación-tp" class="slide level2">
<h2>2. Tasa de Participación (TP)</h2>
<p><span class="math display">\[
TP = \frac{\text{Fuerza de Trabajo}}{\text{Población en Edad de Trabajar}} \times 100
\]</span></p>
<ul>
<li><strong>Numerador</strong>: fuerza de trabajo = ocupados + desocupados.</li>
<li><strong>Denominador</strong>: población en edad de trabajar.</li>
</ul>
</section>
<section id="tasa-de-desempleo-td" class="slide level2">
<h2>3. Tasa de Desempleo (TD)</h2>
<p><span class="math display">\[
TD = \frac{\text{Desocupados}}{\text{Fuerza de Trabajo}} \times 100
\]</span></p>
<ul>
<li><strong>Numerador</strong>: desocupados (personas sin empleo, disponibles y en búsqueda activa).</li>
<li><strong>Denominador</strong>: fuerza de trabajo.</li>
</ul>
</section>
<section id="realción-entre-las-tasas" class="slide level2">
<h2>Realción entre las tasas</h2>
<p>Note que</p>
<p><span class="math display">\[
  TP = \frac{TO}{1 - TD},
\]</span></p>
<p>Sea:</p>
<ul>
<li><span class="math inline">\(PET\)</span> = Población en Edad de Trabajar (denominador común).</li>
<li><span class="math inline">\(O\)</span> = Ocupados.</li>
<li><span class="math inline">\(D\)</span> = Desocupados.</li>
<li>Fuerza de Trabajo: <span class="math inline">\(F = O + D\)</span>.</li>
</ul>
</section>
<section id="indicadores" class="slide level2">
<h2>Indicadores:</h2>
<p><span class="math display">\[
TO = \frac{O}{PET}, \\
\]</span></p>
<p><span class="math display">\[
TP = \frac{F}{PET} = \frac{O + D}{PET}, \\
\]</span></p>
<p><span class="math display">\[
TD = \frac{D}{F} = \frac{D}{O + D}.
\]</span></p>
<p><strong>Condiciones</strong>: <span class="math inline">\(PET&gt;0,\; F&gt;0\)</span> (por tanto <span class="math inline">\(0 \le TD &lt; 1\)</span>).</p>
</section>
<section id="demostración-i" class="slide level2">
<h2>Demostración (I)</h2>
<ol type="1">
<li>Partir de definiciones:</li>
</ol>
<p><span class="math display">\[
TP = \frac{O + D}{PET} = \frac{O}{PET} + \frac{D}{PET} = TO + \frac{D}{PET}.
\]</span></p>
<ol start="2" type="1">
<li>Relacione <span class="math inline">\(\dfrac{D}{PET}\)</span> con <span class="math inline">\(TD\)</span> y <span class="math inline">\(TP\)</span>:</li>
</ol>
<p><span class="math display">\[
\frac{D}{PET} = \frac{D}{O + D}\cdot\frac{O + D}{PET} = TD \cdot TP.
\]</span></p>
</section>
<section id="demostración-ii" class="slide level2">
<h2>Demostración (II)</h2>
<ol start="3" type="1">
<li>Sustituya en la expresión de <span class="math inline">\(TP\)</span>:</li>
</ol>
<p><span class="math display">\[
TP = TO + TD\cdot TP \quad\Rightarrow\quad TP - TD\cdot TP = TO
\]</span></p>
<p><span class="math display">\[
TP(1 - TD) = TO \quad\Rightarrow\quad TP = \frac{TO}{1 - TD}.
\]</span></p>
</section>
<section id="observaciones-i" class="slide level2">
<h2>Observaciones (I)</h2>
<ul>
<li><p>Es necesario <span class="math inline">\(TD&lt;1\)</span> (caso trivial: si <span class="math inline">\(TD=1\)</span> entonces <span class="math inline">\(O=0\)</span> y la TO = 0; la fórmula tiene sentido por continuidad).</p></li>
<li><p>En SAE: al usar estimadores para <span class="math inline">\(TO\)</span> y <span class="math inline">\(TD\)</span> (con varianza asociada), la relación implica que la varianza estimada de <span class="math inline">\(TP\)</span> debe considerar la covarianza entre estimadores de <span class="math inline">\(TO\)</span> y <span class="math inline">\(TD\)</span>.</p></li>
<li><p>Si <span class="math inline">\(\widehat{TP} = \widehat{TO}/(1-\widehat{TD})\)</span>, simulación posterior (MCMC) para obtener varianza/intervalos fiables.</p></li>
<li><p>Para benchmarking y consistencia entre niveles, la relación algebraica permite reexpresar totales y verificar coherencia entre estimaciones por dominio y agregadas.</p></li>
</ul>
</section>
<section id="definición-variable-multinomial" class="slide level2">
<h2>Definición: variable multinomial</h2>
<ul>
<li><p>Sea <span class="math inline">\(K\)</span> el número de categorías de la variable de interés.<br>
<span class="math display">\[
Y_d \sim \text{Multinomial}\big(N_d,\; \boldsymbol{p}_d\big),\qquad
\boldsymbol{p}_d=(p_{d1},\dots,p_{dK}),\quad \sum_{k=1}^K p_{dk}=1.
\]</span></p></li>
<li><p>En el dominio <span class="math inline">\(d\)</span>: <span class="math inline">\(N_d\)</span> es el total de elementos y <span class="math inline">\(N_{dk}\)</span> los elementos en la categoría <span class="math inline">\(k\)</span>.<br>
<span class="math display">\[
p_{dk} = \frac{N_{dk}}{N_d},\qquad \hat p_{dk}=\text{estimador directo de }p_{dk}.
\]</span></p></li>
<li><p>Notación de varianzas directas: <span class="math display">\[
v_{dk} = \operatorname{Var}(\hat p_{dk}),\qquad \widehat v_{dk} = \widehat{\operatorname{Var}}(\hat p_{dk}).
\]</span></p></li>
</ul>
</section>
<section id="tamaño-de-muestra-efectivo-por-categoría-design-effect" class="slide level2">
<h2>Tamaño de muestra efectivo por categoría (design effect)</h2>
<ul>
<li>Debido al diseño muestral, la varianza observada de <span class="math inline">\(\hat p_{dk}\)</span> contiene efecto de diseño. Se define un <strong>tamaño efectivo</strong> aproximado <span class="math inline">\(\tilde n_{dk}\)</span> como</li>
</ul>
<p><span class="math display">\[
\tilde n_{dk} \;=\; \frac{\tilde p_{dk}(1-\tilde p_{dk})}{\widehat v_{dk}},
\]</span></p>
<p>donde <span class="math inline">\(\tilde p_{dk}\)</span> es un estimador estable de la proporción (por ejemplo <span class="math inline">\(\hat p_{dk}\)</span> o una versión suavizada).</p>
<ul>
<li>A partir de <span class="math inline">\(\tilde n_{dk}\)</span> definimos el conteo pseudo-observado</li>
</ul>
<p><span class="math display">\[
\tilde y_{dk} = \tilde n_{dk}\times \hat p_{dk}.
\]</span></p>
<ul>
<li>Luego se define el total efectivo por dominio</li>
</ul>
<p><span class="math display">\[
\hat n_d = \sum_{k=1}^K \tilde y_{dk},
\]</span></p>
<p>y la reconstrucción de conteos coherentes:</p>
<p><span class="math display">\[
\hat y_{dk} = \hat n_d \times \hat p_{dk}.
\]</span></p>
</section>
<section id="modelo-multinomial-logit-jerárquico-formulación" class="slide level2">
<h2>Modelo multinomial-logit jerárquico (formulación)</h2>
<ul>
<li>Para cada dominio <span class="math inline">\(d\)</span> trabajamos con los conteos pseudo-observados <span class="math inline">\((\tilde y_{d1},\dots,\tilde y_{dK})\)</span> condicionados a <span class="math inline">\(\hat n_d\)</span>:</li>
</ul>
<p><span class="math display">\[
(\tilde y_{d1},\dots,\tilde y_{dK}) \mid \hat n_d, \boldsymbol{p}_d
\sim \text{Multinomial}(\hat n_d,\; \boldsymbol{p}_d).
\]</span></p>
<ul>
<li>Modelo lineal para los logits (categoría 1 como referencia): para <span class="math inline">\(k=2,\dots,K\)</span>,</li>
</ul>
<p><span class="math display">\[
\log\frac{p_{dk}}{p_{d1}} \;=\; \mathbf{X}_d^\top \boldsymbol{\beta}_k + u_{dk},
\]</span></p>
<p>donde - <span class="math inline">\(\mathbf{X}_d\in\mathbb{R}^p\)</span>: vector de <span class="math inline">\(p\)</span> covariables del dominio <span class="math inline">\(d\)</span>, - <span class="math inline">\(\boldsymbol{\beta}_k\in\mathbb{R}^p\)</span>: coeficientes fijos de la categoría <span class="math inline">\(k\)</span>, - <span class="math inline">\(u_{dk}\)</span>: efecto aleatorio del dominio <span class="math inline">\(d\)</span> en la categoría <span class="math inline">\(k\)</span>.</p>
</section>
<section id="transformación-a-probabilidades-softmax-con-baseline" class="slide level2">
<h2>Transformación a probabilidades (softmax con baseline)</h2>
<ul>
<li>Para <span class="math inline">\(k=2,\dots,K\)</span> los predictores lineales son</li>
</ul>
<p><span class="math display">\[
\eta_{dk} = \mathbf{X}_d^\top \boldsymbol{\beta}_k + u_{dk}.
\]</span></p>
<ul>
<li>Las probabilidades se obtienen con softmax respecto a la categoría base (1):</li>
</ul>
<p><span class="math display">\[
p_{d1} = \frac{1}{1 + \sum_{m=2}^K e^{\eta_{dm}}},\qquad
p_{dk} = \frac{e^{\eta_{dk}}}{1 + \sum_{m=2}^K e^{\eta_{dm}}},\; k\ge2.
\]</span></p>
</section>
<section id="modelo-bayesiano-verosimilitud-y-priors" class="slide level2">
<h2>Modelo Bayesiano — Verosimilitud y priors</h2>
<ul>
<li>Verosimilitud (independencia entre dominios):</li>
</ul>
<p><span class="math display">\[
\tilde{\mathbf{y}}_d \mid \hat n_d, \boldsymbol{p}_d
\sim \text{Multinomial}(\hat n_d,\boldsymbol{p}_d),\quad d=1,\dots,D.
\]</span></p>
<ul>
<li>Distribución previa:</li>
</ul>
<p><span class="math display">\[
\boldsymbol{\beta}_k \sim \mathcal{N}(0,\,\sigma_\beta^2 I_p),\quad
\sigma_\beta=100.
\]</span></p>
<p><span class="math display">\[
u_d = (u_{d2},\dots,u_{dK})^\top \text{ con estructura: }
u = \operatorname{diag}(\sigma_u)\,L_u\,z_u,
\]</span> <span class="math display">\[
z_u \sim \mathcal{N}(0,I),\quad L_u\sim \text{LKJ Cholesky}(1),\quad
\sigma_{u,j}\sim \text{Inv-Gamma}(\epsilon,\epsilon).
\]</span></p>
</section>
<section id="cantidades-generadas-y-tasas-predicción-por-dominio" class="slide level2">
<h2>Cantidades generadas y tasas (predicción por dominio)</h2>
<ul>
<li>Para dominios de predicción <span class="math inline">\(d'\)</span> con covariables <span class="math inline">\(X_{d'}',Z_{d'}'\)</span> se calculan</li>
</ul>
<p><span class="math display">\[
\hat\eta_{d'k} = X_{d'}'^\top \boldsymbol{\beta}_k + Z_{d'}' u_{d'k},\qquad k\ge2,
\]</span></p>
<p>y las probabilidades <span class="math inline">\(\hat p_{d'k}\)</span>.</p>
<ul>
<li>Tasas de interés:</li>
</ul>
<p><span class="math display">\[
\text{TD}_{d'} = \frac{\hat p_{d'1}}{\hat p_{d'1} + \hat p_{d'2}},\quad
\text{TO}_{d'} = \hat p_{d'2},\quad
\text{TP}_{d'} = \frac{\text{TO}_{d'}}{1-\text{TD}_{d'}}.
\]</span></p>
</section>
<section id="modelo-en-stan-multinomia" class="slide level2">
<h2>Modelo en Stan multinomia</h2>
<pre><code>functions {
  matrix pred_theta(matrix Xp, matrix Zp, int p, matrix beta, matrix u){
  int D1 = rows(Xp);
  real num1[D1, p];
  real den1[D1];
  matrix[D1,p] theta_p;
  matrix[D1,p] tasa_pred;
  
  for(d in 1:D1){
    num1[d, 1] = 1;
    num1[d, 2] = exp(Xp[d, ] * beta[1, ]' + Zp[d, ] * u[1, ]') ;
    num1[d, 3] = exp(Xp[d, ] * beta[2, ]' + Zp[d, ] * u[2, ]') ;
    
    den1[d] = sum(num1[d, ]);
  }
  
  for(d in 1:D1){
    for(i in 2:p){
    theta_p[d, i] = num1[d, i]/den1[d];
    }
    theta_p[d, 1] = 1/den1[d];
   }


for(d in 1:D1){
    tasa_pred[d, 1] = theta_p[d,1]/(theta_p[d,1] + theta_p[d,2]);// TD
    tasa_pred[d, 2] = theta_p[d,2];                              // TO
    tasa_pred[d, 3] = tasa_pred[d, 2]/(1- tasa_pred[d, 1]);               // TP
    }

  return tasa_pred  ;
  }
  
}

data {
  int&lt;lower=1&gt; D;    // número de postestrto 
  int&lt;lower=1&gt; D1;   // número de dominios por predesir 
  int&lt;lower=1&gt; P;    // categorías
  int&lt;lower=1&gt; K;  // cantidad de regresores
  int&lt;lower=1&gt; Kz; // cantidad de regresores en Z
  int y[D, P];       // matriz de datos
  matrix[D, K] X; // matriz de covariables
  matrix[D, Kz] Z; // matriz de covariables
  matrix[D1, K] Xp; // matriz de covariables
  matrix[D1, Kz] Zp; // matriz de covariables
}
  

parameters {
  matrix[P-1, K] beta;// matriz de parámetros 
  vector&lt;lower=0&gt;[P-1] sigma_u;       // random effects standard deviations
  // declare L_u to be the Choleski factor of a 2x2 correlation matrix
  cholesky_factor_corr[P-1] L_u;
  matrix[P-1, Kz] z_u;                  
}

transformed parameters {
  simplex[P] theta[D];// vector de parámetros;
  real num[D, P];
  real den[D];
  // this transform random effects so that they have the correlation
  // matrix specified by the correlation matrix above
  matrix[P-1, Kz] u; // random effect matrix
  u = diag_pre_multiply(sigma_u, L_u) * z_u;
  
  for(d in 1:D){
    num[d, 1] = 1;
    num[d, 2] = exp(X[d, ] * beta[1, ]' + Z[d, ] * u[1, ]') ;
    num[d, 3] = exp(X[d, ] * beta[2, ]' + Z[d, ] * u[2, ]') ;
    
    den[d] = sum(num[d, ]);

  }
  for(d in 1:D){
    for(p in 2:P){
    theta[d, p] = num[d, p]/den[d];
    }
    theta[d, 1] = 1/den[d];
  }
}

model {
  L_u ~ lkj_corr_cholesky(1); // LKJ prior for the correlation matrix
  to_vector(z_u) ~ normal(0, 1);
  sigma_u ~ inv_gamma(0.0001, 0.0001);
  to_vector(beta) ~ normal(0, 100);
 
  for(d in 1:D){
    target += multinomial_lpmf(y[d, ] | theta[d, ]); 
  }
}

  
generated quantities {
  // predict 
  matrix[D1,P] tasa_pred;// vector de parámetros;
  matrix[2, 2] Omega;
  Omega = L_u * L_u'; // so that it return the correlation matrix
// predicción 

tasa_pred = pred_theta(Xp,Zp,P, beta, u) ; 

}
</code></pre>
</section>
<section id="lectura-bases-de-datos-censo." class="slide level2">
<h2>Lectura bases de datos (Censo).</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-36_fa2a1a1c7ad2daf7fc88b3880accbf20">
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">etnia</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">edad</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">anoest</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">107</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">910</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">167</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="lectura-bases-de-datos-encuesta." class="slide level2">
<h2>Lectura bases de datos (Encuesta).</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-37_035bb55d9532dc1a6759d911e5cb1ee7">
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">nombre</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">upm</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">estrato</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">area</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">li</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ingreso</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">etnia</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">anoest</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">edad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">fep</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">empleo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">Tarapacá</td>
<td style="text-align: left;">01100100001</td>
<td style="text-align: left;">011001</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">250001</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Ocupado</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">Tarapacá</td>
<td style="text-align: left;">01100100001</td>
<td style="text-align: left;">011001</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">211092</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Ocupado</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">Tarapacá</td>
<td style="text-align: left;">01100100001</td>
<td style="text-align: left;">011001</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">296751</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Ocupado</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">Tarapacá</td>
<td style="text-align: left;">01100100001</td>
<td style="text-align: left;">011001</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">296751</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Ocupado</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">Tarapacá</td>
<td style="text-align: left;">01100100001</td>
<td style="text-align: left;">011001</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">113958</td>
<td style="text-align: right;">51309</td>
<td style="text-align: right;">113890</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Ocupado</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="lectura-de-datos-covariables" class="slide level2">
<h2>Lectura de datos (Covariables)</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-38_5fdd3df530bc7c299fb685c0552572b8">
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">luces_nocturnas</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cubrimiento_rural</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cubrimiento_urbano</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">modificacion_humana</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">accesibilidad_hospitales</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">accesibilidad_hosp_caminado</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">area1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">etnia2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sexo2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">edad5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">anoest99</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">etnia1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">piso_tierra</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">material_paredes</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">material_techo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rezago_escolar</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">alfabeta</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tasa_desocupacion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">05</td>
<td style="text-align: right;">1.3513</td>
<td style="text-align: right;">-0.3822</td>
<td style="text-align: right;">0.5804</td>
<td style="text-align: right;">-0.4326</td>
<td style="text-align: right;">-0.4944</td>
<td style="text-align: right;">-0.4654</td>
<td style="text-align: right;">0.7832</td>
<td style="text-align: right;">-0.2641</td>
<td style="text-align: right;">0.9270</td>
<td style="text-align: right;">0.2367</td>
<td style="text-align: right;">-0.9039</td>
<td style="text-align: right;">0.2803</td>
<td style="text-align: right;">1.3196</td>
<td style="text-align: right;">-0.8303</td>
<td style="text-align: right;">-0.4020</td>
<td style="text-align: right;">1.0839</td>
<td style="text-align: right;">0.5822</td>
<td style="text-align: right;">-1.0400</td>
<td style="text-align: right;">-0.6748</td>
<td style="text-align: right;">0.7849</td>
<td style="text-align: right;">-0.1419</td>
<td style="text-align: right;">0.9427</td>
<td style="text-align: right;">-0.8311</td>
<td style="text-align: right;">-0.1746</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: right;">-0.7589</td>
<td style="text-align: right;">-0.9654</td>
<td style="text-align: right;">-0.5861</td>
<td style="text-align: right;">0.7200</td>
<td style="text-align: right;">3.0731</td>
<td style="text-align: right;">3.2312</td>
<td style="text-align: right;">0.8740</td>
<td style="text-align: right;">-0.2792</td>
<td style="text-align: right;">-1.2412</td>
<td style="text-align: right;">-0.5137</td>
<td style="text-align: right;">1.0900</td>
<td style="text-align: right;">0.5338</td>
<td style="text-align: right;">0.2594</td>
<td style="text-align: right;">-0.8988</td>
<td style="text-align: right;">0.7717</td>
<td style="text-align: right;">1.2775</td>
<td style="text-align: right;">-1.2498</td>
<td style="text-align: right;">0.5113</td>
<td style="text-align: right;">-0.8387</td>
<td style="text-align: right;">-0.2118</td>
<td style="text-align: right;">0.6301</td>
<td style="text-align: right;">0.9791</td>
<td style="text-align: right;">-1.0626</td>
<td style="text-align: right;">-2.1478</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">-1.0907</td>
<td style="text-align: right;">-0.5922</td>
<td style="text-align: right;">-0.8519</td>
<td style="text-align: right;">-0.0992</td>
<td style="text-align: right;">1.6882</td>
<td style="text-align: right;">1.4095</td>
<td style="text-align: right;">-0.3737</td>
<td style="text-align: right;">-0.2816</td>
<td style="text-align: right;">-1.8908</td>
<td style="text-align: right;">-1.1800</td>
<td style="text-align: right;">1.4718</td>
<td style="text-align: right;">-0.2121</td>
<td style="text-align: right;">-1.1564</td>
<td style="text-align: right;">0.4736</td>
<td style="text-align: right;">-0.3127</td>
<td style="text-align: right;">-0.4177</td>
<td style="text-align: right;">-1.1151</td>
<td style="text-align: right;">1.0405</td>
<td style="text-align: right;">-0.7303</td>
<td style="text-align: right;">0.6679</td>
<td style="text-align: right;">1.0483</td>
<td style="text-align: right;">-0.2585</td>
<td style="text-align: right;">0.6878</td>
<td style="text-align: right;">-1.8449</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">-0.1036</td>
<td style="text-align: right;">0.9024</td>
<td style="text-align: right;">0.1529</td>
<td style="text-align: right;">0.7645</td>
<td style="text-align: right;">-0.1906</td>
<td style="text-align: right;">-0.2802</td>
<td style="text-align: right;">-0.9786</td>
<td style="text-align: right;">-0.2912</td>
<td style="text-align: right;">0.1854</td>
<td style="text-align: right;">-0.6294</td>
<td style="text-align: right;">0.2357</td>
<td style="text-align: right;">0.3076</td>
<td style="text-align: right;">0.0288</td>
<td style="text-align: right;">1.2668</td>
<td style="text-align: right;">-0.2375</td>
<td style="text-align: right;">-0.9033</td>
<td style="text-align: right;">-0.0175</td>
<td style="text-align: right;">0.9851</td>
<td style="text-align: right;">-0.8347</td>
<td style="text-align: right;">0.6664</td>
<td style="text-align: right;">0.8325</td>
<td style="text-align: right;">-0.8919</td>
<td style="text-align: right;">0.8221</td>
<td style="text-align: right;">-0.6736</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: right;">-1.0578</td>
<td style="text-align: right;">-0.9477</td>
<td style="text-align: right;">-1.0118</td>
<td style="text-align: right;">-1.7838</td>
<td style="text-align: right;">-0.4838</td>
<td style="text-align: right;">-0.4509</td>
<td style="text-align: right;">0.8502</td>
<td style="text-align: right;">3.7408</td>
<td style="text-align: right;">-0.1316</td>
<td style="text-align: right;">1.1047</td>
<td style="text-align: right;">-0.0696</td>
<td style="text-align: right;">-1.4474</td>
<td style="text-align: right;">-0.1526</td>
<td style="text-align: right;">-0.9770</td>
<td style="text-align: right;">0.7665</td>
<td style="text-align: right;">0.3527</td>
<td style="text-align: right;">1.1942</td>
<td style="text-align: right;">1.4901</td>
<td style="text-align: right;">2.3843</td>
<td style="text-align: right;">-0.6070</td>
<td style="text-align: right;">-1.8553</td>
<td style="text-align: right;">0.5846</td>
<td style="text-align: right;">-0.8017</td>
<td style="text-align: right;">0.2468</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="compilar-modelo-de-stan-en-r" class="slide level2">
<h2>Compilar modelo de <code>Stan</code> en <code>R</code></h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-39_b96579306508ea489c360b077877d67c">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">source</span>(<span class="st">"recursos/modelo_empleo.R"</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="fu">library</span>(fastDummies)</span>
<span id="cb25-4"><a href="#cb25-4"></a>encuesta_sta_MT <span class="sc">%&lt;&gt;%</span> <span class="fu">dummy_cols</span>(<span class="at">select_columns =</span> <span class="st">"empleo"</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a>multi_fit <span class="ot">&lt;-</span> <span class="fu">modelo_empleo</span>(<span class="at">encuesta_sta =</span> encuesta_sta_MT,</span>
<span id="cb25-6"><a href="#cb25-6"></a>              <span class="at">censo_sta =</span> censo_mrp,</span>
<span id="cb25-7"><a href="#cb25-7"></a>              <span class="at">predictors =</span> statelevel_predictors, </span>
<span id="cb25-8"><a href="#cb25-8"></a>              <span class="at">X_fijo =</span> <span class="st">"luces_nocturnas + cubrimiento_rural + cubrimiento_urbano + modificacion_humana + material_paredes + material_techo + rezago_escolar + alfabeta +tasa_desocupacion"</span>,</span>
<span id="cb25-9"><a href="#cb25-9"></a>              <span class="at">Z_aleatorio =</span> <span class="st">"dam + etnia + edad + area + anoest + sexo"</span>, </span>
<span id="cb25-10"><a href="#cb25-10"></a>              <span class="at">fit_STAN =</span> <span class="st">"recursos/Multinivel_multinomial_no_cor.stan"</span>,</span>
<span id="cb25-11"><a href="#cb25-11"></a>              <span class="at">path_model =</span> <span class="st">"recursos/Multinivel_multinomial_model_no_cor.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compilar-modelo-de-stan-en-r-1" class="slide level2">
<h2>Compilar modelo de <code>Stan</code> en <code>R</code></h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-40_52c9e2f9be0a48da0d3eebfd90e731b2">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">source</span>(<span class="st">"recursos/validar_modelo_bayes.R"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">source</span>(<span class="st">"recursos/Plot_dens_draws.R"</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a>multi_fit <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"recursos/Multinivel_multinomial_model_no_cor.rds"</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a>resul_validar_modelo <span class="ot">&lt;-</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">validar_modelo_bayes</span>(<span class="at">model_bayes =</span> multi_fit<span class="sc">$</span>model_bayes, </span>
<span id="cb26-6"><a href="#cb26-6"></a>                       <span class="at">encuesta_sta =</span> encuesta_sta_MT)</span>
<span id="cb26-7"><a href="#cb26-7"></a></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="fu">saveRDS</span>(resul_validar_modelo, <span class="at">file =</span> <span class="st">"recursos/resul_validar_modelo_no_cor2.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="resultados-del-modelo-r-hat" class="slide level2">
<h2>Resultados del modelo, r-hat</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-42_fef324d21cf17e52f289a2d0a77835a1">
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">description</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Porcen</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">hat(R) &lt;= 1.05</td>
<td style="text-align: right;">5340</td>
<td style="text-align: right;">98.7791</td>
</tr>
<tr class="even">
<td style="text-align: left;">hat(R) &lt;= 1.1</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.4255</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hat(R) &gt; 1.1</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">0.7954</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="resultados-del-modelo-efectos-fijos." class="slide level2">
<h2>Resultados del modelo, efectos fijos.</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-44_d33c5d2d4470970c5bae4e363f2e3fbb">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/plot_E_fijo.png" width="900" height="600"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultados-del-modelo-efectos-aleatorios" class="slide level2">
<h2>Resultados del modelo, efectos aleatorios</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-46_54ec5cb5354d2f6b637137f325bb2c25">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/plot_E_Aleatorio.png" width="1000" height="800"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="resultados-del-modelo-ppc" class="slide level2">
<h2>Resultados del modelo, PPC</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-48_49239b17db37f97c25deb9fca1c68a6c">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/plot_ppc_empelo.png" width="1000" height="800"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="benchmarking" class="title-slide slide level1 center">
<h1>Benchmarking</h1>

</section>
<section id="planteamiento-general" class="slide level2">
<h2>Planteamiento general</h2>
<p>Sea <span class="math inline">\(U = \{1, \dots, N\}\)</span> la población y <span class="math inline">\(S \subset U\)</span> la muestra.</p>
<ul>
<li><p><span class="math inline">\(d_i\)</span>: peso de diseño asociado a la unidad <span class="math inline">\(i \in S\)</span>.</p></li>
<li><p><span class="math inline">\(x_i\)</span>: vector de covariables de calibración.</p></li>
<li><p><span class="math inline">\(y_i\)</span>: variable de interés (ocupación, desocupación, participación).</p></li>
</ul>
<p>El objetivo es ajustar los pesos mediante factores de calibración <span class="math inline">\(g_i\)</span>.</p>
<p><span class="math display">\[
w_i = d_i g_i
\]</span></p>
</section>
<section id="restricciones-de-calibración" class="slide level2">
<h2>Restricciones de calibración</h2>
<p>Los pesos calibrados deben respetar los totales poblacionales:</p>
<p><span class="math display">\[
\sum_{i \in S} w_i x_i = X,
\]</span></p>
<p>donde <span class="math inline">\(X\)</span> proviene de <strong>totales estimados en la encuesta</strong>.</p>
</section>
<section id="estimadores-calibrados" class="slide level2">
<h2>Estimadores calibrados</h2>
<ul>
<li><strong>Tasa de Ocupación (TO):</strong></li>
</ul>
<p><span class="math display">\[
\widehat{TO} =
\frac{\sum_{i \in S} w_i \cdot \mathbb{1}(empleo_i = \text{Ocupado})}
     {\sum_{i \in S} w_i}
\]</span></p>
<ul>
<li><strong>Tasa de Participación (TP):</strong></li>
</ul>
<p><span class="math display">\[
\widehat{TP} =
\frac{\sum_{i \in S} w_i \cdot \mathbb{1}(empleo_i \in \{\text{Ocupado}, \text{Desocupado}\})}
     {\sum_{i \in S} w_i}
\]</span></p>
<ul>
<li><strong>Tasa de Desocupación (TD):</strong></li>
</ul>
<p><span class="math display">\[
\widehat{TD} =
\frac{\sum_{i \in S} w_i \cdot \mathbb{1}(empleo_i = \text{Desocupado})}
     {\sum_{i \in S} w_i \cdot \mathbb{1}(empleo_i \in \{\text{Ocupado}, \text{Desocupado}\})}
\]</span></p>
</section>
<section id="métodos-de-calibración" class="slide level2">
<h2>Métodos de calibración</h2>
<p>El algoritmo <code>calib()</code> resuelve:</p>
<p><span class="math display">\[
\min_{g} \sum_{i \in S} d_i G(g_i) \quad \text{s.a.} \quad \sum_{i \in S} d_i g_i x_i = X.
\]</span></p>
<ul>
<li><p><strong>Lineal:</strong> <span class="math display">\[
g_i = 1 + \lambda^\top x_i
\]</span></p></li>
<li><p><strong>Logit:</strong> <span class="math display">\[
g_i = \frac{\exp(\lambda^\top x_i)}{1 + \exp(\lambda^\top x_i)}.
\]</span></p></li>
</ul>
</section>
<section id="validación-de-la-calibración" class="slide level2">
<h2>Validación de la calibración</h2>
<ul>
<li><p>Comparar <strong>totales estimados vs.&nbsp;totales conocidos</strong>:<br>
<span class="math display">\[
\sum_{i \in S} w_i x_i \approx X
\]</span></p></li>
<li><p>Analizar la distribución de <span class="math inline">\(g_i\)</span>:</p>
<ul>
<li>Todos <span class="math inline">\(g_i &gt; 0\)</span>.<br>
</li>
<li>Evitar valores extremos.<br>
</li>
<li>Revisar proporción de <span class="math inline">\(g_i\)</span> cercanos a 0.</li>
</ul></li>
</ul>
</section>
<section id="benchmarking-1" class="slide level2">
<h2>Benchmarking</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-49_b5888172e8a37881cc4357b22bd34d0b">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">source</span>(<span class="st">"recursos/benchmarking_empleo.R"</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>list_bench <span class="ot">&lt;-</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">benchmarking_empleo</span>(</span>
<span id="cb27-4"><a href="#cb27-4"></a>    <span class="at">encuesta_sta =</span> encuesta_sta_MT,</span>
<span id="cb27-5"><a href="#cb27-5"></a>    <span class="at">poststrat_df =</span> multi_fit<span class="sc">$</span>censo_pred,</span>
<span id="cb27-6"><a href="#cb27-6"></a>    <span class="at">names_cov =</span>  <span class="st">"dam"</span>,</span>
<span id="cb27-7"><a href="#cb27-7"></a>    <span class="at">metodo =</span> <span class="st">"linear"</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>  )</span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="fu">saveRDS</span>(list_bench, <span class="at">file =</span> <span class="st">"recursos/list_bench_empleo.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="validacion-del-benchmarking" class="slide level2">
<h2>Validacion del Benchmarking</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-51_4dcd536cdebee56445c611e09ab97a12">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/plot_bench_empleo.png" width="1000" height="800"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-de-validación-de-estimaciones-i" class="slide level2">
<h2>Plot de validación de estimaciones (I)</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-52_33f31f5c56b23d1d4eeb7ae497c120cd">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>subgrupo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dam"</span>,<span class="st">"sexo"</span>, <span class="st">"area"</span>, <span class="st">"etnia"</span>, <span class="st">"edad"</span>, <span class="st">"anoest"</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a>poststrat_df <span class="ot">&lt;-</span> multi_fit<span class="sc">$</span>censo_pred <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">mutate</span>( <span class="at">gk_TO =</span>list_bench<span class="sc">$</span>gk_bench<span class="sc">$</span>TO,</span>
<span id="cb28-5"><a href="#cb28-5"></a>          <span class="at">gk_TP =</span> list_bench<span class="sc">$</span>gk_bench<span class="sc">$</span>TP,</span>
<span id="cb28-6"><a href="#cb28-6"></a>          <span class="at">gk_TD =</span> list_bench<span class="sc">$</span>gk_bench<span class="sc">$</span>TD )</span>
<span id="cb28-7"><a href="#cb28-7"></a></span>
<span id="cb28-8"><a href="#cb28-8"></a>plot_subgrupo <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb28-9"><a href="#cb28-9"></a>  <span class="at">.x =</span> <span class="fu">setNames</span>(subgrupo, subgrupo),</span>
<span id="cb28-10"><a href="#cb28-10"></a>  <span class="sc">~</span> <span class="fu">plot_compare_Ind</span>(</span>
<span id="cb28-11"><a href="#cb28-11"></a>    <span class="at">sample =</span> encuesta_sta_MT,</span>
<span id="cb28-12"><a href="#cb28-12"></a>    <span class="at">poststrat =</span> poststrat_df,</span>
<span id="cb28-13"><a href="#cb28-13"></a>    <span class="at">by1 =</span> .x</span>
<span id="cb28-14"><a href="#cb28-14"></a>  )</span>
<span id="cb28-15"><a href="#cb28-15"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-de-validación-de-estimaciones-ii" class="slide level2">
<h2>Plot de validación de estimaciones (II)</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-53_27d36a978bde8112eca340763c807afd">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>temp_dir_plot_uni <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">names</span>(plot_subgrupo),</span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="sc">~</span> <span class="fu">ggsave</span>(</span>
<span id="cb29-4"><a href="#cb29-4"></a>    <span class="at">plot =</span> plot_subgrupo[[.x]]<span class="sc">$</span>Plot,</span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="at">filename =</span>    <span class="fu">paste0</span>(<span class="st">"recursos/empleo_plot_uni_"</span>,  .x, <span class="st">".png"</span>),</span>
<span id="cb29-6"><a href="#cb29-6"></a>    <span class="at">scale =</span> <span class="dv">2</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>  )</span>
<span id="cb29-8"><a href="#cb29-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-de-validación-por-dam" class="slide level2">
<h2>Plot de validación por dam</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-54_97936a4ad84933e058c3bef1cf73d1a1">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/empleo_plot_uni_dam.png" width="1000" height="800"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-de-validación-por-años-de-estudio" class="slide level2">
<h2>Plot de validación por años de estudio</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-55_e1b3a151a312cb0ecf2f8af9b9287b87">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/empleo_plot_uni_anoest.png" width="1000" height="800"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-de-validación-por-edad" class="slide level2">
<h2>Plot de validación por edad</h2>
<div class="cell" data-layout-align="center" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-56_c14e6405764360756948bf9cb90b32db">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Recursos/empleo_plot_uni_edad.png" width="1000" height="800"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="benchmarking-para-la-iteración-i" class="slide level2">
<h2>Benchmarking para la iteración <span class="math inline">\(i\)</span></h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-57_24d0413157c0ef4efcfc531f4425a37b">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>ii <span class="ot">=</span> <span class="dv">19</span> </span>
<span id="cb30-2"><a href="#cb30-2"></a>paramtros_chain <span class="ot">&lt;-</span> <span class="fu">as.array</span>(multi_fit<span class="sc">$</span>model_bayes,</span>
<span id="cb30-3"><a href="#cb30-3"></a>                            <span class="at">pars =</span> <span class="st">"tasa_pred"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">as_draws_matrix</span>()</span>
<span id="cb30-5"><a href="#cb30-5"></a></span>
<span id="cb30-6"><a href="#cb30-6"></a>censo_pred_temp <span class="ot">&lt;-</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>  multi_fit<span class="sc">$</span>censo_pred <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"TD"</span>, <span class="st">"TO"</span>, <span class="st">"TP"</span>))</span>
<span id="cb30-8"><a href="#cb30-8"></a></span>
<span id="cb30-9"><a href="#cb30-9"></a>dat_tasa <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb30-10"><a href="#cb30-10"></a>  paramtros_chain[ii,],</span>
<span id="cb30-11"><a href="#cb30-11"></a>  <span class="at">nrow =</span> <span class="fu">nrow</span>(censo_pred_temp),</span>
<span id="cb30-12"><a href="#cb30-12"></a>  <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb30-13"><a href="#cb30-13"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-14"><a href="#cb30-14"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(censo_pred_temp), <span class="fu">c</span>(<span class="st">"TD"</span>, <span class="st">"TO"</span>, <span class="st">"TP"</span>))</span>
<span id="cb30-15"><a href="#cb30-15"></a>) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="benchmarking-para-la-iteración-i-1" class="slide level2">
<h2>Benchmarking para la iteración <span class="math inline">\(i\)</span></h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-58_413f4fc050313051d5100f326629e46e">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>censo_pred_temp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(censo_pred_temp, dat_tasa)</span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="fu">benchmarking_empleo_iter</span>(</span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="at">poststrat_df =</span> censo_pred_temp,</span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="at">Total_Xk =</span> list_bench<span class="sc">$</span>Total,</span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="at">names_cov =</span> list_bench<span class="sc">$</span>var_bench,</span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="at">metodo_calib =</span> list_bench<span class="sc">$</span>metodo_bench</span>
<span id="cb31-8"><a href="#cb31-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="benchmarking-para-todas-las-iteraciones" class="slide level2">
<h2>Benchmarking para todas las iteraciones</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-59_485629a5a44da2c12647b357624bf801">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>result_iter_calib <span class="ot">&lt;-</span> <span class="fu">benchmarking_empleo_all</span>(</span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="at">multi_fit =</span> multi_fit,</span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="at">list_bench =</span> list_bench,</span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="at">pars =</span> <span class="st">"tasa_pred"</span>,</span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="at">n_iter =</span> <span class="dv">100</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>)</span>
<span id="cb32-7"><a href="#cb32-7"></a></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="fu">saveRDS</span>(result_iter_calib, <span class="st">"recursos/result_iter_calib.rds"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="estimaciones" class="title-slide slide level1 center">
<h1>Estimaciones</h1>

</section>
<section id="estimación-nacional-usando-las-cadenas" class="slide level2">
<h2>Estimación nacional usando las cadenas</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-60_34687da431b8e4b1904968235a4469f9">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">source</span>(<span class="st">"recursos/Funciones_empleo.R"</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>result_iter_calib <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"recursos/result_iter_calib.rds"</span>) </span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="fu">map_df</span>(</span>
<span id="cb33-4"><a href="#cb33-4"></a>  result_iter_calib,</span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="sc">~</span> <span class="fu">Indicadores_censo</span>(.x) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> value <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Metodo ,</span>
<span id="cb33-8"><a href="#cb33-8"></a>                <span class="at">values_from =</span> value)</span>
<span id="cb33-9"><a href="#cb33-9"></a>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>  <span class="fu">summarise</span>(<span class="at">estimado =</span> <span class="fu">mean</span>(Bench),</span>
<span id="cb33-11"><a href="#cb33-11"></a>            <span class="at">estimado_se =</span> <span class="fu">sd</span>(Bench))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: right;">estimado</th>
<th style="text-align: right;">estimado_se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TO</td>
<td style="text-align: right;">55.052057</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">TD</td>
<td style="text-align: right;">8.600043</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TP</td>
<td style="text-align: right;">60.232038</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="estimación-dam-usando-las-cadenas" class="slide level2">
<h2>Estimación dam usando las cadenas</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-61_652caf360ca2f004efa2b11a1e19028a">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>tab_dam <span class="ot">&lt;-</span>  <span class="fu">map_df</span>(</span>
<span id="cb34-2"><a href="#cb34-2"></a>  result_iter_calib,</span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="sc">~</span> <span class="fu">Indicadores_censo</span>(.x, <span class="at">var_by =</span> <span class="st">"dam"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> value <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Metodo ,</span>
<span id="cb34-6"><a href="#cb34-6"></a>                <span class="at">values_from =</span> value)</span>
<span id="cb34-7"><a href="#cb34-7"></a>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(variable, dam) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="fu">summarise</span>(<span class="at">estimado =</span> <span class="fu">mean</span>(Bench),</span>
<span id="cb34-9"><a href="#cb34-9"></a>            <span class="at">estimado_se =</span> <span class="fu">sd</span>(Bench))</span>
<span id="cb34-10"><a href="#cb34-10"></a></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="fu">tba</span>(tab_dam <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dam</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimado</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimado_se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TO</td>
<td style="text-align: left;">01</td>
<td style="text-align: right;">58.5903</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">TO</td>
<td style="text-align: left;">02</td>
<td style="text-align: right;">55.7440</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TO</td>
<td style="text-align: left;">03</td>
<td style="text-align: right;">52.7767</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">TO</td>
<td style="text-align: left;">04</td>
<td style="text-align: right;">47.0817</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TO</td>
<td style="text-align: left;">05</td>
<td style="text-align: right;">51.9983</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="estimación-sexo-usando-las-cadenas" class="slide level2">
<h2>Estimación sexo usando las cadenas</h2>
<div class="cell" data-hash="Benchmarking-en-Cadenas-MCMC_cache/revealjs/unnamed-chunk-62_39093167ab3ffbc1879388b8d4b3abee">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>tab_sexo <span class="ot">&lt;-</span>  <span class="fu">map_df</span>(</span>
<span id="cb35-2"><a href="#cb35-2"></a>  result_iter_calib,</span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="sc">~</span> <span class="fu">Indicadores_censo</span>(.x, <span class="at">var_by =</span> <span class="fu">c</span>(<span class="st">"sexo"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> value <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Metodo ,</span>
<span id="cb35-6"><a href="#cb35-6"></a>                <span class="at">values_from =</span> value)</span>
<span id="cb35-7"><a href="#cb35-7"></a>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(variable, sexo) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="fu">summarise</span>(<span class="at">estimado =</span> <span class="fu">mean</span>(Bench),</span>
<span id="cb35-9"><a href="#cb35-9"></a>            <span class="at">estimado_se =</span> <span class="fu">sd</span>(Bench))</span>
<span id="cb35-10"><a href="#cb35-10"></a></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="fu">tba</span>(tab_sexo <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped lightable-classic" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sexo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimado</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimado_se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TO</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">50.3089</td>
<td style="text-align: right;">2.2441</td>
</tr>
<tr class="even">
<td style="text-align: left;">TO</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">61.2466</td>
<td style="text-align: right;">3.3465</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TD</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">13.8426</td>
<td style="text-align: right;">2.9275</td>
</tr>
<tr class="even">
<td style="text-align: left;">TD</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">3.2843</td>
<td style="text-align: right;">2.9355</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TP</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">58.4469</td>
<td style="text-align: right;">3.0652</td>
</tr>
</tbody>
</table>


</div>
</div>
</section></section>
<section id="gracias" class="title-slide slide level1 center">
<h1>¡Gracias!</h1>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Benchmarking en Cadenas MCMC_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1500,

        height: 1000,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>